<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta id="metaViewport" name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes">
    <title>Un d√≠a en Barcelona</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.9.179/pdf.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" integrity="sha512-9usAa10IRO0HhonpyAIVpjrylPvoDwiPUiKdWk5t3PyolY1cOd4DSE0Ga+ri4AuTroPR5aQvXU9xC6qOPnzFeg==" crossorigin="anonymous" referrerpolicy="no-referrer">
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

    
    <style>
      html, body {
    margin: 0;
    padding: 0;
    width: 100vw;
    height: calc(100vh - 120px); /* Resta 10px arriba y 10px abajo */
    overflow: hidden;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    background: #f0f0f0;
    margin-top: 10px;  
}


        #pdf-container {
    width: 100vw;
    height: calc(100vh - 120px); /* Resta 10px arriba y 10px abajo */
    margin: 10px 0; /* M√°rgenes solo arriba y abajo */
    display: flex;
    justify-content: center;
    align-items: center;
    position: relative;
    background: white; /* Asegura contraste si es necesario */
    margin-top: 10px;
    touch-action: pinch-zoom; /* Permite el gesto de pellizco para el zoom */
    overscroll-behavior: none; /* Evita el retroceso en el contenedor del PDF */
}

        canvas {
            width: 100vw;
             height: calc(100vh - 120px); /* Resta 10px arriba y 10px abajo */
             margin-top: 10px;
            
        }
        .nav-button {
    position: fixed; /* Cambio de absolute a fixed */
    top: 50%;
    transform: translateY(-50%);
    background: rgba(0, 0, 0, 0.2);
    border: none;
    color: rgb(195, 34, 34) !important;
    font-size: 30px;
    padding: 10px;
    cursor: pointer;
    border-radius: 10%;
    display: flex;
    justify-content: center;
    width: 25px;
    align-items: center;
    transition: background 0.3s, opacity 0.3s;
    opacity: 1.6;
    z-index: 1000; /* Asegura que est√©n sobre el canvas */
}

        .nav-button:hover {
            background: rgba(0, 0, 0, 0.4);
            opacity: 2;
        }
        #prev-page {
            left: 5px;
            
        }
        #next-page {
            right: 5px;
            
        }

 #replay-button {
    position: absolute;
    top: 0;
    right: 110px; /* Ocupa el lugar donde estaba el bot√≥n de play-pause */
    background: #2ecc71; /* Verde como el bot√≥n anterior */
    border: none;
    padding: 10px;
    cursor: pointer;
    border-radius: 5px;
    transition: background 0.3s;
    width: 40px;
    height: 40px;
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
    font-size: 20px;
}

#replay-button:hover {
    background: #27ae60; /* Color m√°s oscuro al pasar el rat√≥n */
}


#fullscreen-button, #home-button, #replay-button {
    position: absolute;
    top: 0;   
    border: none;
    padding: 10px;
    cursor: pointer;
    border-radius: 5px;
    transition: background 0.3s;
    width: 40px;
    height: 40px;
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
    font-size: 20px;
}

        #fullscreen-button {
            right: 60px;
            background: #3498db;
        }
        #fullscreen-button:hover {
            background: #2980b9;
        }
        #home-button {
            right: 15px;
            background: #e74c3c;
        }
        #home-button:hover {
            background: #c0392b;
        }


@media (max-width: 500px) {
    html, body {
        height: 100vh;
        width: 100vw;
        margin: 0;
        padding: 0;
        overflow: hidden;
        display: flex;
        justify-content: center;
        align-items: center;
        touch-action: pinch-zoom; /* Permite el gesto de pellizco para el zoom */    
        touch-action: pan-x pan-y;
      
        
    }

    #pdf-container {
        display: flex;
        justify-content: center;
        align-items: center;
        width: 100vw;
        height: 100vh;
        overflow: hidden;
        padding: 0;
        margin: 0;
       touch-action: pinch-zoom; /* Permite el gesto de pellizco para el zoom */   
       touch-action: pan-x pan-y;

    }

    canvas {
        width: 100vw !important;  /* üî• Ocupar TODO el ancho */
        height: calc(100vh - 110px) !important; /* üî• Reducir 20px para margen */
        max-width: 100vw;
        max-height: calc(100vh - 110px);
        object-fit: fill !important; /* üî• Asegurar que cubra todo el espacio */
        display: block;
        margin-top: 10px;  /* üî• Agregar margen superior */
        margin-bottom: 100px; /* üî• Agregar margen inferior */
    }

    /* üî• Ocultamos la segunda p√°gina */
    #pdf-render-2 {
        display: none !important;
    }
}






@media (min-width: 501px) and (max-width: 700px) {
    html, body {
        height: 100vh;
        width: 100vw;
        margin: 0;
        padding: 0;
        overflow: hidden;
        display: flex;
        justify-content: center;
        align-items: center;
        touch-action: pan-x pan-y;
    }

    #pdf-container {
        display: flex;
        justify-content: center;
        align-items: center;
        width: 100vw;
        height: 100vh;
        overflow: hidden;
        padding: 0;
        margin: 0;
        touch-action: pan-x pan-y;
    }

    canvas {
        width: 100vw !important; /* üî• Ocupar TODO el ancho disponible */
        height: 100vh !important; /* üî• Ocupar TODO el alto disponible */
        max-width: 100vw !important;
        max-height: 100vh !important;
        display: block;
        object-fit: fill; /* üî• Esto har√° que el PDF rellene completamente el espacio */
    }

    /* üî• Ocultamos la segunda p√°gina */
    #pdf-render-2 {
        display: none !important;
    }
}


@media (min-width: 701px) and (max-width: 1000px) {
    html, body {
        height: 100%;
        width: 100vw;
        margin: 0;
        padding: 0;
        overflow-y: auto !important; /* üî• Permitir desplazamiento vertical */
        overflow-x: auto !important;
        display: flex;
        flex-direction: column;
        justify-content: flex-start;
        align-items: center;
        touch-action: auto;/* SOLO permitir desplazamiento vertical y bloquear zoom */
        overscroll-behavior: auto;
        touch-action: pinch-zoom;
        
    }

    #pdf-container {
        display: flex;
        flex-direction: column;
        justify-content: flex-start;
        align-items: center;
        width: 100vw;
        height: 100vh; /* Ajustar al alto de la pantalla */
        min-height: 100vh !important; /* Asegurar que haya suficiente contenido */
        overflow: auto !important; /* Permitir desplazamiento */
        padding: 0;
        margin: 0;
        overscroll-behavior: auto;
        -webkit-overflow-scrolling: touch; /* Mejora el scroll en iOS */
        touch-action: auto;
    }

    canvas {
        width: 100vw !important;
        height: auto !important;
        max-width: 100vw !important;
        max-height: none !important;
        display: block;
        object-fit: contain;
    }

    /* üî• Ocultamos la segunda p√°gina */
    #pdf-render-2 {
        display: none !important;
    }
}






/* Estilo por defecto (modo inicial) */
@media (min-width: 1001px) {
    html, body {
        height: 100vh;
        width: 100vw;
        margin: 0;
        padding: 0;
        overflow: hidden;
        display: flex;
        justify-content: center;
        align-items: center;
    }
    #pdf-container {
        display: flex;
        flex-direction: row; /* Dos p√°ginas lado a lado */
        justify-content: space-between; /* Asegura que no haya espacio entre p√°ginas */
        align-items: center;
        width: 100vw;
        height: 100vh;
        overflow: hidden;
        padding: 0;
        margin: 0;
    }
    canvas {
        width: 50vw; /* Cada p√°gina ocupa el 50% exacto del ancho */
        height: 100vh; /* Ocupa el 100% del alto */
        max-height: 100vh;
        margin: 0;
        display: block;
    }
}

/* Estilo alternativo (activado al presionar el bot√≥n) */
.alternate-mode {
    html, body {
        height: 100%;
        width: 100vw;
        margin: 0;
        padding: 0;
        overflow-y: auto !important; /* Permitir desplazamiento vertical */
        overflow-x: auto !important;
        display: flex;
        flex-direction: column;
        justify-content: flex-start;
        align-items: center;
        touch-action: auto; /* SOLO permitir desplazamiento vertical y bloquear zoom */
        overscroll-behavior: auto;
        touch-action: pinch-zoom;
    }
    #pdf-container {
        display: flex;
        flex-direction: column;
        justify-content: flex-start;
        align-items: center;
        width: 100vw;
        height: 100vh; /* Ajustar al alto de la pantalla */
        min-height: 100vh !important; /* Asegurar que haya suficiente contenido */
        overflow: auto !important; /* Permitir desplazamiento */
        padding: 0;
        margin: 0;
        overscroll-behavior: auto;
        -webkit-overflow-scrolling: touch; /* Mejora el scroll en iOS */
        touch-action: auto;
    }
    canvas {
        width: 100vw !important;
        height: auto !important;
        max-width: 100vw !important;
        max-height: none !important;
        display: block;
        object-fit: contain;
    }
    /* Ocultamos la segunda p√°gina */
    #pdf-render-2 {
        display: none !important;
    }
}


#switchModeButton {
    width: 40px;
    height: 40px;
    font-size: 16px;
    color: #fff;
    background-color: turquoise;
    border-radius: 5px;
    cursor: pointer;
    transition: background 0.3s;
   
    
}

/* Cambio de √≠cono en el bot√≥n switchModeButton seg√∫n el modo */
#switchModeButton.i-grid {
    content: "\f00b"; /* √çcono fa-th-large */
}

#switchModeButton.i-list {
    content: "\f03e"; /* √çcono fa-list */
}


@keyframes shake {
    0% { transform: translateX(0); }
    25% { transform: translateX(-5px); }
    50% { transform: translateX(5px); }
    75% { transform: translateX(-5px); }
    100% { transform: translateX(0); }
}

.shake {
    animation: shake 0.3s ease-in-out;
}

@keyframes flipPage {
    0% {
        transform: rotateY(0deg);
        opacity: 1;
    }
    50% {
        transform: rotateY(-90deg);
        opacity: 0.5;
    }
    100% {
        transform: rotateY(0deg);
        opacity: 1;
    }
}

.page-flip {
    animation: flipPage 0.6s ease-in-out;
    transform-origin: center;
    perspective: 1000px;
}

#auto-read-button {
    position: absolute;
    top: 0;   
    right: 160px;
    background: #f1c40f; /* Amarillo - Lectura activa */
    border: none;
    padding: 10px;
    cursor: pointer;
    border-radius: 5px;
    transition: background 0.3s, transform 0.2s;
    width: 40px;
    height: 40px;
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
    font-size: 20px;
}

#auto-read-button:hover {
    background: #f39c12;
}

/* üî• Cuando est√° en pausa */
#auto-read-button.paused {
    background: #e67e22; /* Naranja */
}

#auto-read-button.paused:hover {
    background: #d35400;
}

/* Efecto de clic */
#auto-read-button:active {
    transform: scale(0.9);
}


#volume-button {
    position: absolute;
    top: 0;   
    right: 210px; /* Ajuste para que est√© alineado con otros botones */
    background: #9b59b6;
    border: none;
    padding: 10px;
    cursor: pointer;
    border-radius: 5px;
    transition: background 0.3s;
    width: 40px;
    height: 40px;
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
    font-size: 20px;
}

#volume-button:hover {
    background: #8e44ad;
}

#volume-slider {
    position: absolute;
    top: 45px;
    left: 120px;
    width: 100px;
    display: none;
    transition: opacity 0.3s;
}
#page-selector {
    position: absolute;
    top: 0px;
    right: 260px; /* Ajustado para estar a la izquierda del icono de volumen */
    background: transparent;
    padding: 3px 5px;
    height: 40px;
    display: flex;
    align-items: center;    
}

#page-input {
    width: 50px;
    height: 30px;
    border: none;
    padding: 3px;
    text-align: center;
    border-radius: 5px;
    font-size: 16px;
}

#go-to-page {
    background: #df1aa1;

    border: none;
    padding: 5px 10px;
    cursor: pointer;
    border-radius: 5px;
    color: white;
    font-size: 18px;
    margin-left: 5px;
    width: 40px;
    height: 40px;
}

#go-to-page:hover {
    background:  #b62a8a;
}

        /* Men√∫ lateral */
        #button-slider {
            position: fixed;
            top: 20px;
            left: -450px;
            width: 450px;
            height: 40px;
            background: rgba(191, 186, 186, 0.8);
            padding: 20px;
            display: flex;
            flex-direction: row;
            gap: 15px;
            transition: transform 0.3s ease-in-out;
            align-items: center;
            text-align: center;
            margin-left: 10px;
            
        }
        .button-container {
            display: flex;
            flex-direction: row;
            gap: 15px;
            margin-left: 20px;   
          
          
        }
        #slider-toggle {
    position: fixed;
    top: 20px;
    left: 10px;
    background: #8234db;
    border: none;
    height: 40px;
    width: 40px;
    cursor: pointer;
    border-radius: 5px;
    color: white !important; /* üî• Forzar el color blanco en el texto del bot√≥n */
    font-size: 22px;
    display: flex;
    justify-content: center;
    align-items: center;
}

#slider-toggle i {
    color: white !important; /* üî• Forzar el color blanco en el icono */
}

#slider-toggle::before {
    color: white !important; /* üî• Tambi√©n forzar el color en el pseudo-elemento */
}

 #tutorial-overlay {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100vw;
    height: 100vh;
    background: rgba(0, 0, 0, 0.5);
    display: flex;
    justify-content: center;
    align-items: flex-start; /* üî• Alinea el tutorial arriba */
    flex-direction: column;
    color: white;
    font-size: 20px;
    z-index: 2000;
    padding-top: 80px; /* üî• Ajusta para que no tape el men√∫ */
}

.tutorial-content {
    position: absolute;
    top: -50px; /* üî• Ajusta esta altura para que el dedo est√© debajo del men√∫ */
    left: -50px;
    background: rgba(64, 62, 62, 0.9);
    height: 300px;
    width: 300px;
    border-radius: 200px;
    text-align: center;
}

/* Animaci√≥n del dedo üëÜ */
.hand-animation {
    font-size: 30px;
    animation: bounce 1s infinite alternate ease-in-out;
    position: absolute;
    top: 140px; /* üî• Ajusta para que est√© justo debajo del men√∫ */
    left: 55px;
    transform: translateX(-50%);
}

/* Resaltar el bot√≥n del men√∫ */
#slider-toggle {
    position: fixed;
    top: 20px;
    left: 0px;
    z-index: 2100;
   
}

/* Efecto de parpadeo en el men√∫ */
@keyframes pulse {
    0% {
        transform: scale(1);
        box-shadow: 0 0 10px rgba(255, 255, 255, 0.8);
    }
    100% {
        transform: scale(1.2);
        box-shadow: 0 0 20px rgba(255, 255, 255, 1);
    }
}

/* Efecto de rebote para el dedo üëÜ */
@keyframes bounce {
    0% {
        transform: translateY(0);
    }
    100% {
        transform: translateY(-15px);
    }
}

/* Bot√≥n de "Entendido" */
#tutorial-close {
    background: #39db34;
    border: none;
    padding: 9px 9px;
    cursor: pointer;
    border-radius: 20px;
    color: white;
    font-size: 12px;
    margin-top: 0px;
    margin-left: 80px;
}

#tutorial-close:hover {
    background: #227c06;
}

@media (max-width: 1000px) {
    #switchModeButton {
        display: none !important;
    }
}


    </style>
</head>
<body>
    <div id="pdf-container">
        <button id="prev-page" class="nav-button">
            <i class="fas fa-chevron-left"></i>
        </button>
        <canvas id="pdf-render"></canvas>
        <canvas id="pdf-render-2"></canvas> <!-- Segundo canvas para la segunda p√°gina -->

        <button id="next-page" class="nav-button">
            <i class="fas fa-chevron-right"></i>
        </button>

             
        <div id="button-slider">
            <div class="button-container">
                <button id="fullscreen-button" class="slider-button"><i class="fas fa-expand"></i></button>
                <button id="switchModeButton" class="slider-button"> <i class="fas fa-list"></i></button>
                <button id="replay-button" class="slider-button"><i class="fas fa-redo-alt"></i></button>
                <button id="auto-read-button" class="slider-button"><i class="fas fa-book-reader"></i></button>
                <button id="volume-button" class="slider-button"><i class="fas fa-volume-up"></i></button>
                <input id="volume-slider" type="range" min="0" max="1" step="0.1" value="1">
                <button id="home-button" onclick="window.location.href='https://fawzinoo.github.io/Rep/Vocabulario.html'" class="slider-button"><i class="fas fa-home"></i></button>
        
                <!-- Asegura que el selector de p√°gina est√° separado -->
                <div id="page-selector">
                    <input id="page-input" type="number" min="1" placeholder="--" />
                    <button id="go-to-page" class="slider-button"><i class="fas fa-search"></i></button>
                </div>
            </div>
        </div>
        
        <button id="slider-toggle" class="slider-button">
            <i class="fas fa-bars"></i>
        </button>
        
    

        <audio id="pageAudio1">
            <source id="audioSource1" src="https://fawzinoo.github.io/audios/page1.mp3" type="audio/mp3">
        </audio>
        
        <audio id="pageAudio2">
            <source id="audioSource2" src="https://fawzinoo.github.io/audios/page2.mp3" type="audio/mp3">
        </audio>
        <audio id="pageAudio3">
            <source id="audioSource3" src="https://fawzinoo.github.io/audios/page3.mp3" type="audio/mp3">
        </audio>

        <audio id="pageAudio4">
            <source id="audioSource4" src="https://fawzinoo.github.io/audios/page4.mp3" type="audio/mp3">
        </audio>

        <audio id="pageAudio5">
            <source id="audioSource4" src="https://fawzinoo.github.io/audios/page5.mp3" type="audio/mp3">
        </audio>

        <audio id="pageAudio6">
            <source id="audioSource4" src="https://fawzinoo.github.io/audios/page6.mp3" type="audio/mp3">
        </audio>

        <audio id="pageAudio7">
            <source id="audioSource4" src="https://fawzinoo.github.io/audios/page7.mp3" type="audio/mp3">
        </audio>

        <audio id="pageAudio8">
            <source id="audioSource4" src="https://fawzinoo.github.io/audios/page8.mp3" type="audio/mp3">
        </audio>

        <audio id="pageAudio9">
            <source id="audioSource4" src="https://fawzinoo.github.io/audios/page9.mp3" type="audio/mp3">
        </audio>

        <audio id="pageSound">
            <source src="https://www.fesliyanstudios.com/play-mp3/387" type="audio/mp3">
        </audio>     


        <audio id="pageAudio">
            <source id="audioSource" src="" type="audio/mp3">
        </audio>
        
      <!-- üî• Solo se genera si el usuario NO lo ha visto antes -->
<div id="tutorial-overlay" style="display: none;">
    <div class="tutorial-content">
        <div class="hand-animation">üëÜ</div>
        <p style="margin-top: 140px;font-size: 14px;margin-left: 60px;">
            ¬°Toca aqu√≠ para abrir el men√∫!
        </p>
        <button id="tutorial-close">¬°De acuerdo!</button>
    </div>
</div>

        
    </div>
    <script>
    if (sessionStorage.getItem('authenticated') !== 'true') {
        // Muestra un mensaje de error y redirige a la p√°gina principal
        Swal.fire({
            icon: 'error',
            title: 'Acceso restringido',
            text: 'Por favor, autent√≠cate antes de acceder a esta p√°gina.',
            confirmButtonText: 'Volver al inicio'
        }).then(() => {
            window.location.href = 'https://fawzinoo.github.io/Rep/Vocabulario.html';
        });
    }   

        
const url = 'https://fawzinoo.github.io/Fotos/barcelona.pdf';
let pdfDoc = null, pageNum = 1;
let isPlaying = false;
let isAutoReading = false;
const canvas = document.getElementById('pdf-render');
const ctx = canvas.getContext('2d');
const prevPageBtn = document.getElementById("prev-page");
const nextPageBtn = document.getElementById("next-page");
const fullscreenBtn = document.getElementById("fullscreen-button");
const fullscreenIcon = fullscreenBtn.querySelector("i");
const autoReadButton = document.getElementById("auto-read-button");
const autoReadIcon = autoReadButton?.querySelector("i");

if (typeof pdfjsLib === 'undefined') {
    console.error("pdf.js no se carg√≥ correctamente");
} else {
    pdfjsLib.GlobalWorkerOptions.workerSrc = "https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.9.179/pdf.worker.min.js";
}

// Variables para gestos t√°ctiles
let touchStartX = 0;
let touchEndX = 0;
let touchStartY = 0;
let touchEndY = 0;
let touchStartDistance = 0;
let isPinching = false;
const swipeThreshold = 100; // Aumenta el umbral para evitar falsos positivos
const pdfContainer = document.getElementById("pdf-container");

const swipeZoneWidth = 50; // Zona lateral activa (en p√≠xeles)

pdfContainer.addEventListener("touchstart", (e) => {
    if (e.touches.length > 1) return; // Ignorar si hay m√°s de un dedo

    touchStartX = e.touches[0].clientX;
    touchStartY = e.touches[0].clientY;

    // Permitir solo si el toque comienza en los extremos
    if (touchStartX > swipeZoneWidth && touchStartX < window.innerWidth - swipeZoneWidth) {
        touchStartX = null; // Anular swipe si se toc√≥ en el centro
    }
});


document.addEventListener("touchmove", function (e) {
    if (e.touches.length === 2) {
        let touch1 = e.touches[0];
        let touch2 = e.touches[1];

        let deltaX = Math.abs(touch1.clientX - touch2.clientX);
        let deltaY = Math.abs(touch1.clientY - touch2.clientY);

    }
}, { passive: false });

document.addEventListener("gesturestart", function (e) {
    e.preventDefault(); // Bloquea gestos nativos de zoom en algunos navegadores
});

pdfContainer.addEventListener("touchend", (e) => {
    if (touchStartX === null || e.changedTouches.length > 1) return; // Ignorar si el swipe no empez√≥ en los lados

    touchEndX = e.changedTouches[0].clientX;
    touchEndY = e.changedTouches[0].clientY;
    handleSwipe();
});


function handleSwipe() {
    if (touchStartX === null) return; // No hacer nada si el swipe no comenz√≥ en los extremos

    let pageChanged = false;
    const swipeThreshold = 100; // Sensibilidad del swipe

    if (touchStartX - touchEndX > swipeThreshold && pageNum < pdfDoc.numPages) {
        pageNum++;
        pageChanged = true;
    } else if (touchEndX - touchStartX > swipeThreshold && pageNum > 1) {
        pageNum--;
        pageChanged = true;
    }

    if (pageChanged) {
        renderPage(pageNum);
        stopAllAudio();

        if (isAutoReading) {
            if (!isPaused) {
                playAudioForPage(pageNum);
            } else {
                resetAutoReadButton();
            }
        } else {
            resetAutoReadButton();
        }
    }
}














// Sonido al pasar p√°gina
function playPageSound() {
    const pageSound = document.getElementById("pageSound");
    if (pageSound) {
        pageSound.currentTime = 0;
        pageSound.play();
    }
}



function renderPage(num) {
    if (!pdfDoc) return;

    // üî• Guardar la p√°gina actual en LocalStorage
    localStorage.setItem("lastPage", num);

    const isMobile = window.innerWidth <= 500; // üì± Detecta si es un m√≥vil
    const isTablet = window.innerWidth > 500 && window.innerWidth <= 1000; // üì≤ Detecta si es una tablet
    const isTwoPages = window.innerWidth > 1000; // üñ•Ô∏è Detecta si hay dos p√°ginas en pantalla

    // üî• Ajustamos la escala dependiendo del dispositivo
    const scale = isTwoPages ? 2.5 : isTablet ? 3.5 : 4.5; // üìè Ajuste de escala

    playPageSound(); // üéµ Reproduce sonido al pasar p√°gina

    // Actualizar el n√∫mero en el input del selector de p√°gina
    const pageInput = document.getElementById("page-input");
    if (pageInput) {
        pageInput.value = num; // üî• Actualiza el input con la p√°gina actual
    }

    // Renderiza la primera p√°gina
    pdfDoc.getPage(num).then(page => {
        const viewport = page.getViewport({ scale });

        canvas.width = viewport.width;
        canvas.height = viewport.height;

        const renderContext = { canvasContext: ctx, viewport: viewport };
        page.render(renderContext);
    });

    // üîä **Actualizar los audios seg√∫n la p√°gina actual**
    const audio1 = document.getElementById("pageAudio1");
    const audioSource1 = document.getElementById("audioSource1");
    audioSource1.src = `https://fawzinoo.github.io/audios/page${num}.mp3`;
    audio1.load();

    // üî• Restaurar el tiempo del audio si hay un valor guardado
    const lastAudioTime = localStorage.getItem("lastAudioTime");
    if (lastAudioTime !== null) {
        audio1.currentTime = parseFloat(lastAudioTime);
    }

    if (isTwoPages && num + 1 <= pdfDoc.numPages) {
        const audio2 = document.getElementById("pageAudio2");
        const audioSource2 = document.getElementById("audioSource2");
        audioSource2.src = `https://fawzinoo.github.io/audios/page${num + 1}.mp3`;
        audio2.load();
    }

    // Renderiza la segunda p√°gina si hay espacio para dos
    const canvas2 = document.getElementById('pdf-render-2');
    const ctx2 = canvas2.getContext('2d');

    if (isTwoPages && num + 1 <= pdfDoc.numPages) {
        pdfDoc.getPage(num + 1).then(page => {
            const viewport = page.getViewport({ scale });

            canvas2.width = viewport.width;
            canvas2.height = viewport.height;

            const renderContext = { canvasContext: ctx2, viewport: viewport };
            page.render(renderContext);
        });
    } else {
        // ‚ùå Ocultar la segunda p√°gina en m√≥viles y tablets
        canvas2.style.display = isTwoPages ? "block" : "none"; 

        // Rellenar el segundo canvas con gris si es necesario
        canvas2.width = canvas.width;
        canvas2.height = canvas.height;
        ctx2.fillStyle = "#ccc";
        ctx2.fillRect(0, 0, canvas2.width, canvas2.height);
    }
}


 
// Cargar PDF
pdfjsLib.getDocument(url).promise.then(pdf => {
    pdfDoc = pdf;
    renderPage(pageNum);
});


nextPageBtn.addEventListener("click", () => {
    const isTwoPages = window.innerWidth > 1000;
    const nextPageNum = pageNum + (isTwoPages ? 2 : 1);

    if (nextPageNum <= pdfDoc.numPages) {
        pageNum = nextPageNum;
        renderPage(pageNum);
        stopAllAudio();

        if (isAutoReading) {
            if (!isPaused) {
                playAudioForPage(pageNum); // üî• Si est√° en curso, reproduce el nuevo audio
            } else {
                resetAutoReadButton(); // üî• Si estaba pausado, reinicia el bot√≥n
            }
        } else {
            resetAutoReadButton(); // üî• Si NO est√° en curso, reinicia el bot√≥n
        }
    }
});

prevPageBtn.addEventListener("click", () => {
    if (pageNum > 1) {
        pageNum -= (window.innerWidth > 1000) ? 2 : 1;
        if (pageNum < 1) pageNum = 1;
        renderPage(pageNum);
        stopAllAudio();

        if (isAutoReading) {
            if (!isPaused) {
                playAudioForPage(pageNum); // üî• Si est√° en curso, reproduce el nuevo audio
            } else {
                resetAutoReadButton(); // üî• Si estaba pausado, reinicia el bot√≥n
            }
        } else {
            resetAutoReadButton(); // üî• Si NO est√° en curso, reinicia el bot√≥n
        }
    }
});









const replayButton = document.getElementById("replay-button");

replayButton.addEventListener("click", () => {
    stopAllAudio(); // üî• Detener cualquier audio en reproducci√≥n
    resetAutoReadButton(); // üî• Restablecer el bot√≥n de lectura autom√°tica
    startAutoReading(); // üî• Comenzar la lectura autom√°tica desde la p√°gina actual
});









let isPaused = false;
let currentAudio = document.getElementById("pageAudio1");

autoReadButton.addEventListener("click", () => {
    if (!isAutoReading) {
        startAutoReading();
    } else {
        toggleAutoReading();
    }
});

function startAutoReading() {
    isAutoReading = true;
    isPaused = false;
    autoReadIcon.classList.remove("fa-book-reader", "fa-play");
    autoReadIcon.classList.add("fa-pause");
    autoReadButton.classList.remove("paused");

    playAudioForPage(pageNum); // üî• Inicia la lectura desde la p√°gina actual
}

function resetAutoReadButton() {
    isAutoReading = false;
    isPaused = false;
    autoReadIcon.classList.remove("fa-pause", "fa-play");
    autoReadIcon.classList.add("fa-book-reader");
    autoReadButton.classList.remove("paused");
    stopAllAudio(); // üî• Detener todos los audios
}


function toggleAutoReading() {
    if (isPaused) {
        isPaused = false;
        autoReadIcon.classList.remove("fa-play");
        autoReadIcon.classList.add("fa-pause");
        autoReadButton.classList.remove("paused");

        if (currentAudio) {
            currentAudio.play().catch(e => console.error("Error al reanudar audio:", e));
        }
    } else {
        isPaused = true;
        autoReadIcon.classList.remove("fa-pause");
        autoReadIcon.classList.add("fa-play");
        autoReadButton.classList.add("paused");

        if (currentAudio) {
            currentAudio.pause();
        }
    }
}

function stopAutoReading() {
    isAutoReading = false;
    isPaused = false;
    autoReadIcon.classList.remove("fa-pause", "fa-play");
    autoReadIcon.classList.add("fa-book-reader");
    autoReadButton.classList.remove("paused");
    stopAllAudio();
    resetAutoReadButton()
}


const isLargeScreen = window.innerWidth > 1000; // üî• Pantallas grandes

function playAudioForPage(num) {
    if (!isAutoReading) return; // üî• Solo reproduce si la lectura continua est√° activa

    const audio1 = document.getElementById("pageAudio1");
    const audio2 = document.getElementById("pageAudio2");

    if (!audio1) {
        console.error("Elemento de audio 1 no encontrado.");
        return;
    }

    // Cargar y reproducir el primer audio (p√°gina actual)
    audio1.src = `https://fawzinoo.github.io/audios/page${num}.mp3`;
    audio1.load();
    audio1.currentTime = 0;
    audio1.play().catch(e => console.error("Error al reproducir audio 1:", e));

    // Cuando termine el primer audio, verificar si hay un segundo audio
    audio1.onended = () => {
        if (!isAutoReading || isPaused) return;

        // Si es una pantalla grande y hay una p√°gina siguiente, cargar y reproducir el segundo audio
        if (isLargeScreen && num + 1 <= pdfDoc.numPages && audio2) {
            audio2.src = `https://fawzinoo.github.io/audios/page${num + 1}.mp3`;
            audio2.load();
            audio2.currentTime = 0;
            audio2.play().catch(e => console.error("Error al reproducir audio 2:", e));

            // Cuando termine el segundo audio, avanzar a la siguiente p√°gina
            audio2.onended = () => {
                if (!isAutoReading || isPaused) return;

                const nextPage = num + 2; // üî• Avanzar dos p√°ginas
                if (nextPage <= pdfDoc.numPages) {
                    pageNum = nextPage;
                    renderPage(pageNum);
                    playAudioForPage(pageNum); // Reproducir la siguiente p√°gina
                } else {
                    stopAutoReading(); // Detener si no hay m√°s p√°ginas
                    resetAutoReadButton(); // üî• Restablecer el bot√≥n
                }
            };
        } else {
            // Si no hay un segundo audio, avanzar a la siguiente p√°gina
            const nextPage = num + 1; // üî• Avanzar una p√°gina
            if (nextPage <= pdfDoc.numPages) {
                pageNum = nextPage;
                renderPage(pageNum);
                playAudioForPage(pageNum); // Reproducir la siguiente p√°gina
            } else {
                stopAutoReading(); // Detener si no hay m√°s p√°ginas
                resetAutoReadButton(); // üî• Restablecer el bot√≥n
            }
        }
    };
}


function stopAllAudio() {
    if (currentAudio) {
        // üî• Guarda el tiempo del audio en LocalStorage
        localStorage.setItem("lastAudioTime", currentAudio.currentTime);
        currentAudio.pause();
        currentAudio.currentTime = 0;
        currentAudio.onended = null;
    }
}















const volumeButton = document.getElementById("volume-button");
const volumeSlider = document.getElementById("volume-slider");
let volumeTimeout;

// Funci√≥n para mostrar el control de volumen
function showVolumeSlider() {
    volumeSlider.style.display = "block";
    volumeSlider.style.opacity = "1";
    resetVolumeTimeout();
}

// Funci√≥n para ocultar el control de volumen
function hideVolumeSlider() {
    volumeSlider.style.opacity = "0";
    setTimeout(() => {
        if (volumeSlider.style.opacity === "0") {
            volumeSlider.style.display = "none";
        }
    }, 300); // Esconde el slider despu√©s de la animaci√≥n
}

// Funci√≥n para reiniciar el temporizador de ocultaci√≥n
function resetVolumeTimeout() {
    clearTimeout(volumeTimeout);
    volumeTimeout = setTimeout(hideVolumeSlider, 2000); // Ocultar despu√©s de 2 segundos
}

// Mostrar el control al presionar el bot√≥n
volumeButton.addEventListener("click", showVolumeSlider);

// Ajustar volumen y actualizar el icono
volumeSlider.addEventListener("input", () => {
    const volume = volumeSlider.value;
    document.querySelectorAll("audio").forEach(audio => {
        audio.volume = volume;
    });

    // Cambiar el icono seg√∫n el nivel de volumen
    if (volume == 0) {
        volumeButton.innerHTML = '<i class="fas fa-volume-mute"></i>';
    } else if (volume <= 0.5) {
        volumeButton.innerHTML = '<i class="fas fa-volume-down"></i>';
    } else {
        volumeButton.innerHTML = '<i class="fas fa-volume-up"></i>';
    }

    resetVolumeTimeout(); // Reiniciar el temporizador al mover el slider
});

// Ocultar el slider cuando el usuario deja de moverlo
volumeSlider.addEventListener("mouseleave", resetVolumeTimeout);





// -------------------------------------------------------------------------------
const pageInput = document.getElementById("page-input");
const goToPageButton = document.getElementById("go-to-page");

// Funci√≥n para cambiar de p√°gina de forma fiable en m√≥viles
function goToPage() {
    const requestedPage = parseInt(pageInput.value, 10);

    if (isNaN(requestedPage) || requestedPage < 1 || requestedPage > pdfDoc.numPages) {
        Swal.fire({
            icon: 'error',
            title: 'Error',
            text: 'N√∫mero de p√°gina inv√°lido',
            confirmButtonText: 'Aceptar'
        });
        return;
    }


    pageNum = requestedPage;

    // üî• Ocultar teclado en m√≥viles y evitar scroll inesperado
    pageInput.blur();
    document.activeElement.blur();
    window.scrollTo(0, 0);

    // üî• Forzar la actualizaci√≥n del input en m√≥viles
    setTimeout(() => {
        pageInput.value = pageNum;
    }, 50);

    // üî• Asegurar que el canvas se vuelve a renderizar correctamente
    setTimeout(() => {
        renderPage(pageNum);

        // üî• Forzar actualizaci√≥n del canvas en m√≥viles
        setTimeout(() => {
            canvas.style.display = "none";
            setTimeout(() => {
                canvas.style.display = "block";
            }, 50);
        }, 100);

        // üî• Si pausamos y cambiamos de p√°gina, restaurar el bot√≥n de lectura continua
        isAutoReading = false;
        isPaused = false;
        autoReadIcon.classList.remove("fa-pause", "fa-play");
        autoReadIcon.classList.add("fa-book-reader");
        autoReadButton.classList.remove("paused");

        // üî• Detener cualquier audio en reproducci√≥n
        stopAllAudio();

    }, 300);
}

// üõ†Ô∏è **Forzar el clic en m√≥viles**
goToPageButton.addEventListener("touchstart", (event) => {
    event.preventDefault(); // üî• Evita cualquier interferencia del navegador
    goToPage();
});

goToPageButton.addEventListener("click", goToPage);

// üì± **Compatibilidad con teclado en m√≥viles**
pageInput.addEventListener("keyup", (event) => {
    if (event.key === "Enter") {
        goToPage();
    }
});

// üì± **Forzar ocultar teclado en m√≥viles al perder el foco**
pageInput.addEventListener("blur", () => {
    setTimeout(() => {
        window.scrollTo(0, 0);
    }, 100);
});




//---------------------------------------------------------------------------------------





const slider = document.getElementById("button-slider");
        const toggleButton = document.getElementById("slider-toggle");
        let sliderVisible = false;

        toggleButton.addEventListener("click", () => {
    sliderVisible = !sliderVisible;

    // Determinar el tama√±o del desplazamiento seg√∫n el ancho de la pantalla
    let slideWidth = window.innerWidth < 1001 ? 400 : 450;

    slider.style.transform = sliderVisible ? `translateX(${slideWidth}px)` : "translateX(0)";
});



document.addEventListener("DOMContentLoaded", () => {
    const tutorialOverlay = document.getElementById("tutorial-overlay");
    const tutorialClose = document.getElementById("tutorial-close");

    // üîç Verificar si los elementos existen antes de continuar
    if (!tutorialOverlay || !tutorialClose) {
        console.error("‚ö†Ô∏è Error: No se encontraron los elementos del tutorial.");
        return;
    }

    // üöÄ Comprobar si el usuario ya vio el tutorial antes de mostrarlo
    if (localStorage.getItem("tutorialVisto") === "true") {
        tutorialOverlay.remove(); // üî• Lo eliminamos completamente para que nunca se renderice
    } else {
        // ‚úÖ Si el usuario nunca lo ha visto, lo mostramos
        setTimeout(() => {
            tutorialOverlay.style.display = "flex";
        }, 500); // üî• Peque√±o delay opcional para evitar parpadeo

        // üéØ Evento para cerrar con el bot√≥n "De acuerdo"
        tutorialClose.addEventListener("click", () => {
            localStorage.setItem("tutorialVisto", "true"); // ‚úÖ Guardamos el estado
            tutorialOverlay.style.display = "none";
            setTimeout(() => {
                tutorialOverlay.remove(); // ‚úÖ Eliminamos el tutorial del DOM despu√©s de ocultarlo
            }, 100);
        });

        // üéØ Tambi√©n ocultarlo si el usuario hace clic fuera del mensaje
        tutorialOverlay.addEventListener("click", (event) => {
            if (event.target === tutorialOverlay) {
                localStorage.setItem("tutorialVisto", "true");
                tutorialOverlay.style.display = "none";
                setTimeout(() => {
                    tutorialOverlay.remove();
                }, 100);
            }
        });
    }

    // üî• **Cargar la √∫ltima p√°gina y restaurar audio**
    const savedPage = localStorage.getItem("lastPage");
    if (savedPage !== null) {
        pageNum = parseInt(savedPage, 10);
    } else {
        pageNum = 1; // Si no hay datos guardados, empezamos en la primera p√°gina
    }

    renderPage(pageNum); // üî• Renderizar la √∫ltima p√°gina guardada

    // üîä **Cargar la √∫ltima posici√≥n del audio**
    const lastAudioTime = localStorage.getItem("lastAudioTime");
    if (lastAudioTime !== null) {
        const audio1 = document.getElementById("pageAudio1");
        if (audio1) {
            audio1.currentTime = parseFloat(lastAudioTime);
        }
    }
});

   

let inactivityTimeout;

function resetInactivityTimer() {
    clearTimeout(inactivityTimeout);
    inactivityTimeout = setTimeout(() => {
        window.location.href = 'https://fawzinoo.github.io/Rep/Vocabulario.html';
    }, 1800000); //
}

document.addEventListener('mousemove', resetInactivityTimer);
document.addEventListener('keydown', resetInactivityTimer);
document.addEventListener('click', resetInactivityTimer);

resetInactivityTimer();

document.addEventListener("DOMContentLoaded", () => {
    const switchModeButton = document.getElementById('switchModeButton');
    const body = document.body;

    let isAlternateMode = false;

    function toggleMode() {
        isAlternateMode = !isAlternateMode;

        if (isAlternateMode) {
            body.classList.add('alternate-mode');
            document.documentElement.style.overflow = 'auto';
            switchModeButton.innerHTML = '<i class="fas fa-columns"></i>';
            switchModeButton.title = 'Cambiar a Modo Lado a Lado';
        } else {
            body.classList.remove('alternate-mode');
            document.documentElement.style.overflow = 'hidden';
            switchModeButton.innerHTML = '<i class="fas fa-list"></i>';
            switchModeButton.title = 'Cambiar a Modo Columna';
        }
    }
  
    if (switchModeButton) {
        switchModeButton.addEventListener('click', toggleMode);
    }
});





// Pantalla completa
fullscreenBtn.addEventListener("click", () => {
    if (!document.fullscreenElement) {
        document.documentElement.requestFullscreen().then(() => {
            if (fullscreenIcon) {
                fullscreenIcon.classList.remove("fa-expand");
                fullscreenIcon.classList.add("fa-compress");
            }
        });
    } else {
        document.exitFullscreen().then(() => {
            if (fullscreenIcon) {
                fullscreenIcon.classList.remove("fa-compress");
                fullscreenIcon.classList.add("fa-expand");
            }
        });
    }
});

    </script>
</body>
</html>
