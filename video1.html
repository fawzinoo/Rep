<!DOCTYPE html>
<html lang="es">
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Reproductor de Video</title>
	<style>
		:root {
			color-scheme: light dark;
		}

        body {
            margin: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
            background: linear-gradient(145deg, #f8f4ec 0%, #f2e8d5 100%);
            color: #0b1120;
            padding: 32px 20px;
            box-sizing: border-box;
        }

		.player-shell {
			--shell-pad-x: 32px;
			--shell-pad-y: 32px;
			width: min(92vw, 960px);
            --shell-pad-x: 0;
            --shell-pad-y: 0;
            padding: 0 !important;
            margin: 0 !important;
            background: transparent !important;
            box-shadow: none !important;
            backdrop-filter: none !important;
            border-radius: 0 !important;
			border-radius: 24px;
			background: rgba(10, 15, 24, 0.82);
			backdrop-filter: blur(14px);
			box-shadow: 0 20px 60px rgba(0, 0, 0, 0.45);
			transition: padding 160ms ease, border-radius 160ms ease;
			position: relative;
		}

		h1 {
			margin: 0 0 24px;
			font-size: 1.6rem;
			font-weight: 600;
			letter-spacing: 0.04em;
		}

		video {
			width: 100%;
			display: block;
			border-radius: 18px;
			background: #020409;
		}

		.controls {
			position: absolute;
			left: var(--shell-pad-x);
			right: var(--shell-pad-x);
			bottom: var(--shell-pad-y);
			padding: 18px 22px 2px 22px;
			display: flex;
			flex-wrap: wrap;
			align-items: center;
			gap: 12px;
			background: transparent;
			border-bottom-left-radius: 18px;
			border-bottom-right-radius: 18px;
			z-index: 2;
		}

		.controls button,
		.controls input[type="range"] {
			-webkit-appearance: none;
			appearance: none;
		}

		.controls button {
			width: 44px;
			height: 44px;
			border-radius: 12px;
			border: none;
			cursor: pointer;
			background: linear-gradient(145deg, #0f172a, #1f2a44);
			color: #f8fafc;
			font-size: 18px;
			display: grid;
			place-items: center;
			transition: transform 120ms ease, box-shadow 120ms ease, background 120ms ease;
		}

		.controls button:hover {
			background: linear-gradient(145deg, #1d2b4a, #2f3b5f);
			box-shadow: 0 10px 18px rgba(10, 15, 24, 0.35);
		}

		.controls button:active {
			transform: scale(0.96);
		}

		.controls button svg {
			width: 22px;
			height: 22px;
			fill: currentColor;
			display: none;
		}

		#control-play[data-state="play"] .icon-play,
		#control-play[data-state="pause"] .icon-pause {
			display: block;
		}

		#control-volume[data-state="high"] .icon-volume-high,
		#control-volume[data-state="mute"] .icon-volume-muted {
			display: block;
		}

		#control-fullscreen[data-state="enter"] .icon-enter,
		#control-fullscreen[data-state="exit"] .icon-exit {
			display: block;
		}

		.controls .progress {
			flex: 1 1 460px;
			min-width: 240px;
			display: flex;
			flex-direction: column;
			gap: 8px;
			align-items: flex-start;
		}

		.controls .progress input[type="range"] {
			flex: 1;
			width: 100%;
			height: 6px;
			background: none;
		}

		.controls .progress input[type="range"]::-webkit-slider-runnable-track {
			height: 6px;
			border-radius: 999px;
			background: linear-gradient(90deg, #38bdf8 var(--seek-filled, 0%), rgba(148, 163, 184, 0.4) var(--seek-filled, 0%));
		}

		.controls .progress input[type="range"]::-webkit-slider-thumb {
			-webkit-appearance: none;
			appearance: none;
			width: 14px;
			height: 14px;
			border-radius: 50%;
			background: #38bdf8;
			box-shadow: 0 0 0 4px rgba(56, 189, 248, 0.22);
			margin-top: -4px;
		}

		.controls .progress input[type="range"]::-moz-range-track {
			height: 6px;
			border-radius: 999px;
			background: linear-gradient(90deg, #38bdf8 var(--seek-filled, 0%), rgba(148, 163, 184, 0.4) var(--seek-filled, 0%));
		}

		.controls .progress input[type="range"]::-moz-range-thumb {
			width: 14px;
			height: 14px;
			border-radius: 50%;
			border: none;
			background: #38bdf8;
			box-shadow: 0 0 0 4px rgba(56, 189, 248, 0.22);
		}

		.controls .primary-controls {
			display: flex;
			flex-direction: row;
			align-items: center;
			gap: 12px;
			margin-right: auto;
		}

		.controls .primary-controls #control-play {
			order: 0;
		}

		.controls .primary-controls .volume {
			order: 1;
			flex: 0 0 auto;
		}

		.controls .primary-controls .timecode {
			order: 2;
		}

		.timecode {
			display: flex;
			align-items: center;
			height: 44px;
			font-variant-numeric: tabular-nums;
			font-size: 0.9rem;
			color: #000000;
			margin-top: 0;
		}

		.controls .volume {
			position: relative;
			display: flex;
			align-items: center;
			justify-content: center;
			margin-left: 0;
		}

		.controls .volume button {
			z-index: 2;
		}

		.volume.open #control-volume {
			background: linear-gradient(145deg, #38bdf8, #0ea5e9);
			color: #0b1120;
			box-shadow: 0 12px 26px rgba(14, 165, 233, 0.28);
		}

		.volume-slider {
			position: absolute;
			gap: 8px;
			align-items: flex-start;
			left: 50%;
			transform: translateX(-50%);
			display: none;
			align-items: center;
			justify-content: center;
			padding: 14px 12px;
			border-radius: 14px;
			background: rgba(10, 15, 24, 0.92);
			box-shadow: 0 20px 40px rgba(0, 0, 0, 0.45);
			backdrop-filter: blur(12px);
		}

		.volume.open .volume-slider {
			display: flex;
		}

		.volume-slider input[type="range"] {
			width: 40px;
			height: 90px;
			padding: 0;
			background: none;
			writing-mode: bt-lr;
			-webkit-appearance: slider-vertical;
			appearance: slider-vertical;
		}

		.volume-slider input[type="range"]::-webkit-slider-runnable-track {
			height: 6px;
			border-radius: 999px;
			background: linear-gradient(0deg, #38bdf8 var(--volume-filled, 100%), rgba(148, 163, 184, 0.35) var(--volume-filled, 100%));
		}

		.volume-slider input[type="range"]::-webkit-slider-thumb {
			-webkit-appearance: none;
			appearance: none;
			width: 14px;
			height: 14px;
			border-radius: 50%;
			background: #38bdf8;
			box-shadow: 0 0 0 4px rgba(56, 189, 248, 0.18);
			margin: 0;
		}

		.volume-slider input[type="range"]::-moz-range-track {
			height: 6px;
			border-radius: 999px;
			background: linear-gradient(0deg, #38bdf8 var(--volume-filled, 100%), rgba(148, 163, 184, 0.35) var(--volume-filled, 100%));
		}

		.volume-slider input[type="range"]::-moz-range-thumb {
			width: 14px;
			height: 14px;
			border-radius: 50%;
			border: none;
			background: #38bdf8;
			box-shadow: 0 0 0 4px rgba(56, 189, 248, 0.18);
			margin: 0;
		}

		.volume-slider input[type="range"]:focus-visible {
			outline: none;
			box-shadow: 0 0 0 3px rgba(56, 189, 248, 0.35);
			border-radius: 12px;
		}

		.controls .speed {
			position: relative;
			display: flex;
			align-items: center;
			justify-content: center;
			margin-left: auto;
		}

		#control-fullscreen {
			margin-left: 8px;
		}

		#speed-toggle {
			width: 44px;
			height: 44px;
			border-radius: 12px;
			border: none;
			cursor: pointer;
			display: grid;
			place-items: center;
			background: linear-gradient(145deg, #243049, #1b2436);
			color: #f8fafc;
			font-size: 0.95rem;
			font-weight: 600;
			line-height: 1;
			transition: transform 120ms ease, box-shadow 120ms ease, background 120ms ease;
		}

		#speed-toggle:hover {
			background: linear-gradient(145deg, #2f3a54, #2a3651);
			box-shadow: 0 12px 20px rgba(24, 34, 53, 0.35);
		}

		#speed-toggle:active {
			transform: scale(0.97);
		}

		.speed.open #speed-toggle {
			background: linear-gradient(145deg, #38bdf8, #0ea5e9);
			color: #0b1120;
			box-shadow: 0 12px 26px rgba(14, 165, 233, 0.28);
		}

		.speed-menu {
			position: absolute;
			bottom: 56px;
			right: 0;
			display: none;
			flex-direction: column;
			gap: 6px;
			padding: 14px 12px;
			border-radius: 14px;
			background: rgba(10, 15, 24, 0.92);
			box-shadow: 0 22px 44px rgba(0, 0, 0, 0.45);
			backdrop-filter: blur(12px);
			min-width: 120px;
			z-index: 5;
		}

		.speed-menu button {
			width: 100%;
			padding: 8px 12px;
			border-radius: 10px;
			border: none;
			background: transparent;
			color: rgba(226, 232, 240, 0.9);
			font-size: 0.95rem;
			text-align: left;
			cursor: pointer;
			transition: background 120ms ease, color 120ms ease;
		}

		.speed-menu button:hover,
		.speed-menu button:focus-visible {
			background: rgba(56, 189, 248, 0.18);
			color: #e0f2fe;
		}

		.speed-menu button.active {
			background: rgba(14, 165, 233, 0.4);
			color: #f0f9ff;
		}

		.speed.open .speed-menu {
			display: flex;
		}

		.status {
			min-height: 1.5em;
			margin-top: 18px;
			color: rgba(148, 163, 184, 0.9);
			text-align: center;
		}

		@media (max-width: 680px) {
			body {
				align-items: flex-start;
				padding: 18px 0 26px;
			}

			.player-shell {
				width: calc(100% - 1px);
				margin: 0 auto;
				--shell-pad-x: 12px;
				--shell-pad-y: 20px;
				padding: var(--shell-pad-y) var(--shell-pad-x) !important;
				margin: 0 auto !important;
				border-radius: 18px;
			}

			h1 {
				font-size: 1.28rem;
				margin-bottom: 16px;
			}

			video {
				border-radius: 14px;
			}

			.controls {
				gap: 8px;
				padding: 12px 14px 4px 14px;
				border-bottom-left-radius: 14px;
				border-bottom-right-radius: 14px;
			}

			.controls button,
			#speed-toggle {
				width: 36px;
				height: 36px;
				border-radius: 9px;
			}

			.controls .progress {
				order: 1;
				flex-basis: 100%;
				margin-top: 0;
			}

			.controls .primary-controls {
				order: 2;
				width: 100%;
				margin-right: 0;
			}

			#speed-control {
				order: 3;
			}

			#control-fullscreen {
				order: 4;
			}

			.timecode {
				display: flex;
				align-items: center;
				height: 36px;
				font-size: 0.84rem;
				color: #000000;
				margin-top: 0;
			}

			.volume.open .volume-slider {
				bottom: 52px;
			}

			.speed-menu {
				bottom: 48px;
			}
		}

		@media (max-width: 430px) {
			.player-shell {
				--shell-pad-x: 5px;
				--shell-pad-y: 16px;
				padding: var(--shell-pad-y) var(--shell-pad-x) !important;
			}

			.controls {
				padding: 10px 10px 14px;
				gap: 6px;
				border-bottom-left-radius: 12px;
				border-bottom-right-radius: 12px;
			}

			video {
				border-radius: 12px;
			}

			.timecode {
				display: flex;
				align-items: center;
				height: 32px;
				font-size: 0.8rem;
				color: #000000;
				margin-top: 0;
			}

			.controls .progress input[type="range"]::-webkit-slider-thumb,
			.controls .progress input[type="range"]::-moz-range-thumb {
				width: 10px;
				height: 10px;
			}

			.volume-slider {
				bottom: 48px;
			}

			.speed-menu {
				bottom: 44px;
			}
		}

		a {
			color: #38bdf8;
		}
	</style>
</head>
<body>
	<div class="player-shell">
		<h1 style="text-align: center;">Una fiesta</h1>
		<video id="player" src="https://ik.imagekit.io/b8cowcw9j/video1.mp4" preload="metadata" playsinline tabindex="0">
			Tu navegador no puede reproducir este video.
		</video>
		<div class="controls">
			<div class="progress" style="flex: 1 0 100%; order: 0;">
				<input id="seek" type="range" min="0" value="0" step="0.05" aria-label="Barra de progreso">
			</div>
			<div class="primary-controls" style="display: flex; flex-direction: row; align-items: center; gap: 12px;">
				<button id="control-play" type="button" aria-label="Reproducir" data-state="play">
					<svg class="icon icon-play" viewBox="0 0 32 32" aria-hidden="true"><path d="M10 6.5v19l16-9.5z"></path></svg>
					<svg class="icon icon-pause" viewBox="0 0 32 32" aria-hidden="true"><path d="M11 7h4v18h-4zm6 0h4v18h-4z"></path></svg>
				</button>
				<div class="volume" id="volume-control">
					<button id="control-volume" type="button" aria-label="Silenciar" data-state="high" aria-haspopup="true" aria-expanded="false">
						<svg class="icon icon-volume-high" viewBox="0 0 32 32" aria-hidden="true"><path d="M6 12h5l6-5v18l-6-5H6zm15.5-6.5v3.3c2.2 0.9 3.5 2.6 3.5 4.7s-1.3 3.8-3.5 4.7v3.3c4-1.2 6.5-4.1 6.5-7.9s-2.6-6.7-6.5-7.9z"></path></svg>
						<svg class="icon icon-volume-muted" viewBox="0 0 32 32" aria-hidden="true"><path d="M6 12h5l6-5v18l-6-5H6zm16.8 3.6 2.6-2.6 1.6 1.6-2.6 2.6 2.6 2.6-1.6 1.6-2.6-2.6-2.6 2.6-1.6-1.6 2.6-2.6-2.6-2.6 1.6-1.6z"></path></svg>
					</button>
					<div class="volume-slider" id="volume-popover" role="presentation" aria-hidden="true">
						<input id="volume" type="range" min="0" max="1" step="0.01" value="1" aria-label="Volumen" orient="vertical">
					</div>
				</div>
				<div class="timecode" id="time">00:00 / 00:00</div>
		
			<div class="speed" id="speed-control">
				<button id="speed-toggle" type="button" aria-haspopup="true" aria-expanded="false" aria-label="Cambiar velocidad">1x</button>
				<div id="speed-menu" class="speed-menu" role="menu" aria-label="Seleccionar velocidad">
					<button type="button" role="menuitemradio" data-rate="0.5">0,5×</button>
					<button type="button" role="menuitemradio" data-rate="0.75">0,75×</button>
					<button type="button" role="menuitemradio" data-rate="1" aria-checked="true">Normal</button>
					<button type="button" role="menuitemradio" data-rate="1.25">1,25×</button>
					<button type="button" role="menuitemradio" data-rate="1.5">1,5×</button>
					<button type="button" role="menuitemradio" data-rate="2">2×</button>
				</div>
			</div>
			<button id="control-fullscreen" type="button" aria-label="Pantalla completa" data-state="enter">
				<svg class="icon icon-enter" viewBox="0 0 32 32" aria-hidden="true"><path d="M6 6h8v2H8v6H6zm12 0h8v8h-2V8h-6zm6 12h2v8h-8v-2h6zm-14 6h6v2H6v-8h2z"></path></svg>
				<svg class="icon icon-exit" viewBox="0 0 32 32" aria-hidden="true"></svg>
					<g fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round">
					<path d="M16 13h-6.5V5.5"></path>
					<path d="M16 13h6.5V5.5"></path>
					<path d="M16 19h-6.5v7.5"></path>
					<path d="M16 19h6.5v7.5"></path>
					</g>
				</svg>
			</button>
        </div>
        </div>
	</div>
	<p id="status" class="status" role="alert"></p>
	<script>
		const statusEl = document.getElementById("status");
		const player = document.getElementById("player");
		const playBtn = document.getElementById("control-play");
		const seek = document.getElementById("seek");
		const timecode = document.getElementById("time");
		const volumeBtn = document.getElementById("control-volume");
		const volumeControl = document.getElementById("volume-control");
		const volumePopover = document.getElementById("volume-popover");
		const volumeSlider = document.getElementById("volume");
		const fullBtn = document.getElementById("control-fullscreen");
		const speedControl = document.getElementById("speed-control");
		const speedToggle = document.getElementById("speed-toggle");
		const speedMenu = document.getElementById("speed-menu");
		const speedOptions = [...speedMenu.querySelectorAll("button[data-rate]")];
		let volumeCycleStage = 0;
		let lastVolume = Number(volumeSlider.value) || 1;

		const formatTime = (seconds) => {
			if (!Number.isFinite(seconds)) {
				return "00:00";
			}
			const total = Math.max(seconds, 0);
			const h = Math.floor(total / 3600);
			const m = Math.floor((total % 3600) / 60);
			const s = Math.floor(total % 60);
			const base = `${m.toString().padStart(2, "0")}:${s.toString().padStart(2, "0")}`;
			return h > 0 ? `${h}:${base}` : base;
		};

		const updateSeekVisual = () => {
			if (!seek.max) {
				return;
			}
			const percent = (seek.value / seek.max) * 100;
			seek.style.setProperty("--seek-filled", `${percent}%`);
		};

		const updateVolumeVisual = () => {
			const percent = Number(volumeSlider.value) * 100;
			volumeSlider.style.setProperty("--volume-filled", `${percent}%`);
		};

		const openVolumeMenu = () => {
			volumeControl.classList.add("open");
			volumeBtn.setAttribute("aria-expanded", "true");
			volumePopover.setAttribute("aria-hidden", "false");
		};

		const closeVolumeMenu = (resetStage = false) => {
			volumeControl.classList.remove("open");
			volumeBtn.setAttribute("aria-expanded", "false");
			volumePopover.setAttribute("aria-hidden", "true");
			if (resetStage) {
				volumeCycleStage = 0;
			}
		};

		const syncTime = () => {
			const duration = Number.isFinite(player.duration) ? player.duration : 0;
			timecode.textContent = `${formatTime(player.currentTime)} / ${formatTime(duration)}`;
			seek.value = player.currentTime;
			updateSeekVisual();
		};

		const togglePlay = () => {
			if (player.paused) {
				player.play().catch(() => {});
			} else {
				player.pause();
			}
		};

		const updatePlayButton = () => {
			playBtn.dataset.state = player.paused ? "play" : "pause";
			playBtn.setAttribute("aria-label", player.paused ? "Reproducir" : "Pausar");
		};

		const updateVolumeButton = () => {
			const muted = player.muted || player.volume === 0;
			volumeBtn.dataset.state = muted ? "mute" : "high";
			volumeBtn.setAttribute("aria-label", muted ? "Activar sonido" : "Silenciar");
		};

		const toggleMute = () => {
			player.muted = !player.muted;
		};

		const toggleFullscreen = () => {
			if (!document.fullscreenElement) {
				player.parentElement.requestFullscreen?.();
			} else {
				document.exitFullscreen?.();
			}
		};

		const updateFullscreenButton = () => {
			const active = Boolean(document.fullscreenElement);
			fullBtn.dataset.state = active ? "exit" : "enter";
			fullBtn.setAttribute("aria-label", active ? "Salir de pantalla completa" : "Pantalla completa");
		};

		const formatRate = (rate) => rate.toLocaleString("es-ES", { maximumFractionDigits: 2 });

		const closeSpeedMenu = () => {
			speedControl.classList.remove("open");
			speedToggle.setAttribute("aria-expanded", "false");
			speedMenu.setAttribute("aria-hidden", "true");
		};

		const openSpeedMenu = () => {
			speedControl.classList.add("open");
			speedToggle.setAttribute("aria-expanded", "true");
			speedMenu.setAttribute("aria-hidden", "false");
		};

		const toggleSpeedMenu = () => {
			if (speedControl.classList.contains("open")) {
				closeSpeedMenu();
			} else {
				openSpeedMenu();
				const active = speedOptions.find((btn) => btn.classList.contains("active"));
				active?.focus({ preventScroll: true });
			}
		};

		const updateSpeedVisuals = () => {
			const current = player.playbackRate;
			const label = current === 1 ? "1x" : `${formatRate(current)}x`;
			speedToggle.textContent = label;
			speedOptions.forEach((button) => {
				const rate = Number(button.dataset.rate);
				const active = Math.abs(rate - current) < 0.011;
				button.classList.toggle("active", active);
				button.setAttribute("aria-checked", active ? "true" : "false");
			});
		};

		playBtn.addEventListener("click", togglePlay);
		player.addEventListener("click", togglePlay);
		player.addEventListener("play", updatePlayButton);
		player.addEventListener("pause", updatePlayButton);

		player.addEventListener("loadedmetadata", () => {
			const duration = Number.isFinite(player.duration) ? player.duration : 0;
			seek.max = duration;
			seek.disabled = duration === 0;
			syncTime();
			statusEl.textContent = "";
		});

		player.addEventListener("timeupdate", syncTime);

		seek.addEventListener("input", () => {
			const newTime = Number(seek.value);
			player.currentTime = newTime;
			const duration = Number.isFinite(player.duration) ? player.duration : 0;
			timecode.textContent = `${formatTime(newTime)} / ${formatTime(duration)}`;
			updateSeekVisual();
		});

		volumeSlider.addEventListener("input", () => {
			const level = Number(volumeSlider.value);
			player.volume = level;
			if (level > 0) {
				lastVolume = level;
				if (player.muted) {
					player.muted = false;
				}
			}
			updateVolumeVisual();
		});

		player.addEventListener("volumechange", () => {
			const current = player.muted ? 0 : player.volume;
			volumeSlider.value = current;
			if (!player.muted && current > 0) {
				lastVolume = current;
			}
			updateVolumeButton();
			updateVolumeVisual();
		});

		volumeBtn.addEventListener("click", (event) => {
			event.stopPropagation();
			const isMuted = player.muted || Number(volumeSlider.value) === 0;
			if (isMuted) {
				player.muted = false;
				const restored = lastVolume > 0 ? lastVolume : 0.5;
				player.volume = restored;
				openVolumeMenu();
				volumeSlider.focus({ preventScroll: true });
				volumeCycleStage = 1;
				return;
			}
			if (volumeCycleStage === 0) {
				openVolumeMenu();
				volumeSlider.focus({ preventScroll: true });
				volumeCycleStage = 1;
				return;
			}
			if (volumeCycleStage === 1) {
				closeVolumeMenu();
				volumeCycleStage = 2;
				return;
			}
			if (volumeCycleStage === 2) {
				lastVolume = Number(volumeSlider.value) || lastVolume || 0.5;
				player.muted = true;
				closeVolumeMenu(true);
				volumeCycleStage = 0;
				return;
			}
			// Fallback: reset and open
			volumeCycleStage = 0;
			openVolumeMenu();
		});

		volumePopover.addEventListener("click", (event) => event.stopPropagation());
		volumeSlider.addEventListener("focus", () => {
			openVolumeMenu();
			if (volumeCycleStage < 1) {
				volumeCycleStage = 1;
			}
		});
		volumeSlider.addEventListener("pointerdown", (event) => event.stopPropagation());
		volumeSlider.addEventListener("mousedown", (event) => event.stopPropagation());
		volumeSlider.addEventListener("touchstart", (event) => event.stopPropagation(), { passive: true });

		fullBtn.addEventListener("click", toggleFullscreen);
		document.addEventListener("fullscreenchange", updateFullscreenButton);

		speedToggle.addEventListener("click", toggleSpeedMenu);

		speedOptions.forEach((button) => {
			button.addEventListener("click", () => {
				const rate = Number(button.dataset.rate);
				player.playbackRate = rate;
				updateSpeedVisuals();
				closeSpeedMenu();
				speedToggle.focus({ preventScroll: true });
			});
		});

		document.addEventListener("click", (event) => {
			if (!speedControl.contains(event.target)) {
				closeSpeedMenu();
			}
			if (!volumeControl.contains(event.target)) {
				closeVolumeMenu(true);
			}
		});

		document.addEventListener("keydown", (event) => {
			if (event.key !== "Escape") {
				return;
			}
			let handled = false;
			if (speedControl.classList.contains("open")) {
				closeSpeedMenu();
				speedToggle.focus({ preventScroll: true });
				handled = true;
			}
			if (volumeControl.classList.contains("open")) {
				closeVolumeMenu(true);
				volumeBtn.focus({ preventScroll: true });
				handled = true;
			}
			if (handled) {
				event.preventDefault();
			}
		});

		player.addEventListener("ratechange", updateSpeedVisuals);

		player.addEventListener("keydown", (event) => {
			if (event.code === "Space") {
				event.preventDefault();
				togglePlay();
			}
		});

		player.addEventListener("error", () => {
			const error = player.error;
			if (!error) {
				statusEl.textContent = "";
				return;
			}

			const codes = {
				1: "La carga se canceló.",
				2: "",
				3: "El archivo está dañado o en un formato no compatible.",
				4: ""
			};

			statusEl.textContent = codes[error.code] || "";
		});

		player.volume = Number(volumeSlider.value);
		lastVolume = player.volume || lastVolume;
		updatePlayButton();
		updateVolumeButton();
		updateFullscreenButton();
		updateSeekVisual();
		updateVolumeVisual();
		player.playbackRate = 1;
		updateSpeedVisuals();
		closeSpeedMenu();
		closeVolumeMenu(true);
	</script>
</body>
</html>
