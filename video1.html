<!DOCTYPE html>
<html lang="es">
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Reproductor de Video</title>
	<style>
		:root {
			color-scheme: light dark;
		}

		body {
			margin: 0;
			display: flex;
			flex-direction: column;
			align-items: center;
			justify-content: flex-start;
			min-height: 100vh;
			font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
			background: linear-gradient(145deg, #f8f4ec 0%, #f2e8d5 100%);
			color: #0b1120;
			padding: 32px clamp(16px, 6vw, 52px) 160px;
			box-sizing: border-box;
			width: 100%;
		}

		.player-shell {
			--shell-pad-x: 0;
			--shell-pad-y: 0;
			width: 100%;
			max-width: 960px;
			margin: 0 auto;
			padding: 0;
			border-radius: 24px;
			background: transparent;
			box-shadow: none;
			transition: padding 160ms ease, border-radius 160ms ease;
			position: relative;
		}

		@media (orientation: landscape) and (max-width: 1024px) {
			body {
				padding: 0 0 64px;
				align-items: stretch;
			}

			.player-shell {
				max-width: none;
				width: 100%;
				border-radius: 0;
				background: #000;
			}

			.player-shell > h1 {
				display: none;
			}

			video,
			.video-background {
				width: 100%;
				height: calc(100vh - 64px);
				max-height: 100vh;
				border-radius: 0;
				object-fit: cover;
			}

			.transcript-container {
				max-width: none;
			}
		}

		.player-shell:fullscreen,
		.player-shell:-webkit-full-screen {
			width: 100vw;
			height: 100vh;
			max-width: none;
			margin: 0;
			border-radius: 0;
			padding: 0 !important;
		}

		.player-shell:fullscreen video,
		.player-shell:-webkit-full-screen video,
		.player-shell:fullscreen .video-background,
		.player-shell:-webkit-full-screen .video-background {
			border-radius: 0;
			height: 100%;
			width: 100%;
			object-fit: contain;
		}

		.player-shell:fullscreen .controls,
		.player-shell:-webkit-full-screen .controls {
			left: 0;
			right: 0;
			bottom: 0;
		}

		h1 {
			margin: 0 0 24px;
			font-size: 1.6rem;
			font-weight: 600;
			letter-spacing: 0.04em;
		}

		video {
			width: 100%;
			display: block;
			border-radius: 18px;
			background: #000;
			object-fit: cover;
			object-position: center;
			position: relative;
		}
		
		.video-background {
			position: absolute;
			top: 0;
			left: 0;
			width: 100%;
			height: 100%;
			display: flex;
			align-items: center;
			justify-content: center;
			pointer-events: none;
			z-index: 1;
			border-radius: 18px;
			box-sizing: border-box;
			opacity: 0;
			transition: opacity 0.3s ease;
			background: linear-gradient(135deg, #ffb347 0%, #ff8c42 100%);
		}
		
		.video-background.visible {
			opacity: 1;
		}
		
		.background-content {
			text-align: center;
			max-width: 600px;
			padding: 40px;
		}
		
		.background-level {
			font-size: 0.95rem;
			font-weight: 600;
			color: rgba(255, 255, 255, 0.95);
			margin-bottom: 16px;
			letter-spacing: 0.15em;
			text-transform: uppercase;
			text-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
		}
		
		.background-unit {
			font-size: 1.5rem;
			font-weight: 600;
			color: #ffffff;
			margin-bottom: 20px;
			line-height: 1.4;
			text-shadow: 0 3px 10px rgba(0, 0, 0, 0.25);
			letter-spacing: 0.02em;
		}
		
		.background-title {
			font-size: 3.5rem;
			font-weight: 700;
			color: #ffffff;
			line-height: 1.1;
			text-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
			letter-spacing: -0.02em;
		}

		.playback-overlay {
			position: absolute;
			inset: 0;
			display: flex;
			align-items: center;
			justify-content: center;
			opacity: 0;
			pointer-events: none;
			transition: opacity 0.22s ease;
			z-index: 3;
		}

		.playback-overlay.show {
			opacity: 1;
		}

		.playback-overlay .overlay-circle {
			width: 72px;
			height: 72px;
			border-radius: 50%;
			background: rgba(15, 23, 42, 0.35);
			backdrop-filter: blur(8px);
			display: grid;
			place-items: center;
			box-shadow: 0 18px 38px rgba(15, 23, 42, 0.35);
		}

		.playback-overlay svg {
			width: 50px;
			height: 50px;
			fill: #f8fafc;
			opacity: 0.92;
			filter: drop-shadow(0 6px 14px rgba(15, 23, 42, 0.55));
		}

		.playback-overlay [data-icon] {
			display: none;
		}

		.playback-overlay[data-state="play"] [data-icon="play"],
		.playback-overlay[data-state="pause"] [data-icon="pause"] {
			display: block;
		}

	.controls {
		position: absolute;
		left: var(--shell-pad-x);
		right: var(--shell-pad-x);
		bottom: var(--shell-pad-y);
		padding: 18px 22px 2px 22px;
		display: flex;
		flex-wrap: wrap;
		align-items: center;
		gap: 12px;
		background: linear-gradient(to top, rgba(0, 0, 0, 0.5) 0%, rgba(0, 0, 0, 0.3) 50%, transparent 100%);
		border-bottom-left-radius: 18px;
		border-bottom-right-radius: 18px;
		z-index: 2;
		padding-top: 60px;
		transform: translateY(0);
		opacity: 1;
		transition: opacity 200ms ease, transform 200ms ease;
	}		.controls button,
		.controls input[type="range"] {
			-webkit-appearance: none;
			appearance: none;
		}

	.controls.hidden {
		opacity: 0;
		transform: translateY(18px);
		pointer-events: none;
	}

		.controls button {
			width: 44px;
			height: 44px;
			border-radius: 12px;
			border: none;
			cursor: pointer;
			background: transparent;
			color: #f8fafc;
			font-size: 18px;
			display: grid;
			place-items: center;
			transition: transform 120ms ease, box-shadow 120ms ease, background 120ms ease;
		}

		.controls button:hover {
			background: transparent;
			box-shadow: none;
		}

		.controls button:active {
			transform: scale(0.96);
		}

		.controls button:active,
		.controls button:focus {
			background: transparent;
		}

		.controls button svg {
			width: 26px;
			height: 26px;
			fill: currentColor;
			display: none;
			filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.8));
			stroke: currentColor;
			stroke-width: 0.5;
			stroke-linejoin: round;
			stroke-linecap: round;
		}

	#control-play[data-state="play"] .icon-play,
	#control-play[data-state="pause"] .icon-pause,
	#control-play[data-state="replay"] .icon-replay {
		display: block;
	}		#control-volume[data-state="high"] .icon-volume-high,
		#control-volume[data-state="mute"] .icon-volume-muted {
			display: block;
		}

		#control-fullscreen[data-state="enter"] .icon-enter,
		#control-fullscreen[data-state="exit"] .icon-exit {
			display: block;
            margin-left: 8px;
		}

		.controls .progress {
			flex: 1 1 460px;
			min-width: 240px;
			display: flex;
			flex-direction: column;
			gap: 8px;
			align-items: flex-start;
			margin-bottom: -10px;
			
			position: relative;
			z-index: 3;
		}

		.controls .progress input[type="range"] {
			flex: 1;
			width: 100%;
			height: 6px;
			background: none;
			touch-action: pan-y;
		}

		.controls .progress input[type="range"]::-webkit-slider-runnable-track {
			height: 6px;
			border-radius: 999px;
			background: linear-gradient(90deg, #38bdf8 var(--seek-filled, 0%), rgba(148, 163, 184, 0.4) var(--seek-filled, 0%));
		}

		.controls .progress input[type="range"]::-webkit-slider-thumb {
			-webkit-appearance: none;
			appearance: none;
			width: 14px;
			height: 14px;
			border-radius: 50%;
			background: #38bdf8;
			box-shadow: 0 0 0 4px rgba(56, 189, 248, 0.22);
			margin-top: -4px;
		}

		.controls .progress input[type="range"]::-moz-range-track {
			height: 6px;
			border-radius: 999px;
			background: linear-gradient(90deg, #38bdf8 var(--seek-filled, 0%), rgba(148, 163, 184, 0.4) var(--seek-filled, 0%));
		}

		.controls .progress input[type="range"]::-moz-range-thumb {
			width: 14px;
			height: 14px;
			border-radius: 50%;
			border: none;
			background: #38bdf8;
			box-shadow: 0 0 0 4px rgba(56, 189, 248, 0.22);
		}

		.controls .primary-controls {
			display: flex;
			flex-direction: row;
			align-items: center;
			gap: 12px;
			margin-right: auto;
			margin-right: auto;
		}

		.controls .primary-controls #control-play {
			order: 0;
		}

		.controls .primary-controls .volume {
			order: 1;
			flex: 0 0 auto;
		}

		.controls .primary-controls .timecode {
			order: 2;
		}

		.timecode {
			display: flex;
			align-items: center;
			height: 44px;
			font-variant-numeric: tabular-nums;
			font-size: 0.9rem;
			color: #f8fafc;
			margin-top: 0;
			text-shadow: 0 2px 4px rgba(0, 0, 0, 0.8);
			gap: 4px;
		}
		
		.skip-button {
			background: rgba(0, 0, 0, 0.4);
			border: none;
			padding: 8px;
			cursor: pointer;
			display: flex;
			align-items: center;
			justify-content: center;
			width: 44px;
			height: 44px;
			color: #ffffff;
			transition: transform 0.15s ease, background 0.15s ease;
			border-radius: 4px;
			margin-top: -9px;
            margin-right: 1px;
            margin-left: -5px;

		}
		
		.skip-button:hover {
			transform: scale(1.1);
			background: rgba(0, 0, 0, 0.6);
		}
		
		.skip-button .icon {
			width: 35px;
			height: 35px;
			display: block;
			fill: currentColor;
			filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.8));

           
		}

        		.skip-button1 {
			background: rgba(0, 0, 0, 0.4);
			border: none;
			padding: 8px;
			cursor: pointer;
			display: flex;
			align-items: center;
			justify-content: center;
			width: 44px;
			height: 44px;
			color: #ffffff;
			transition: transform 0.15s ease, background 0.15s ease;
			border-radius: 4px;
			margin-top: -9px;
		}		.skip-button1:hover {
			transform: scale(1.1);
			background: rgba(0, 0, 0, 0.6);

		}
		
		.skip-button1 .icon1 {
			width: 35px;
			height: 35px;
			display: block;
			fill: currentColor;
			filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.8));
             margin-left: -10px;
          

		}

		.controls .volume {
			position: relative;
			display: flex;
			align-items: center;
			justify-content: center;
			margin-left: -12px;
			z-index: 4;
		}

		.controls .volume button {
			z-index: 2;
		}

		.volume.open #control-volume {
			background: transparent;
			color: #f8fafc;
			box-shadow: none;
		}

	.volume-slider {
		position: absolute;
		left: 50%;
		bottom: 100%;
		margin-bottom: 2px;
		transform: translateX(-50%);
		display: none;
		align-items: center;
		justify-content: center;
		padding: 4px 2px;
		border-radius: 10px;
		background: rgba(10, 15, 24, 0.92);
		box-shadow: 0 20px 40px rgba(0, 0, 0, 0.45);
		backdrop-filter: blur(12px);
		width: 12px;
		height: auto;
		min-height: 100px;
		z-index: 5;
	}		.volume.open .volume-slider {
			display: flex;
		}

	.volume-slider input[type="range"] {
		-webkit-appearance: none;
		appearance: none;
		width: 90px;
		height: 6px;
		padding: 0;
		margin: 0;
		background: transparent;
		transform: rotate(-90deg);
		transform-origin: center;
		cursor: pointer;
	}		.volume-slider input[type="range"]::-webkit-slider-runnable-track {
			height: 6px;
			border-radius: 999px;
			background: linear-gradient(90deg, #38bdf8 var(--volume-filled, 100%), rgba(148, 163, 184, 0.35) var(--volume-filled, 100%));
		}

		.volume-slider input[type="range"]::-webkit-slider-thumb {
			-webkit-appearance: none;
			appearance: none;
			width: 0;
			height: 0;
			opacity: 0;
		}

		.volume-slider input[type="range"]::-moz-range-track {
			height: 6px;
			border-radius: 999px;
			background: linear-gradient(90deg, #38bdf8 var(--volume-filled, 100%), rgba(148, 163, 184, 0.35) var(--volume-filled, 100%));
		}

		.volume-slider input[type="range"]::-moz-range-thumb {
			width: 0;
			height: 0;
			border: none;
			opacity: 0;
		}

		.volume-slider input[type="range"]:focus-visible {
			outline: none;
			box-shadow: 0 0 0 3px rgba(56, 189, 248, 0.35);
			border-radius: 12px;
		}

		.controls .speed {
			position: relative;
			display: flex;
			align-items: center;
			justify-content: center;
            margin-right: -20px;
		}

		.controls .secondary-controls {
			display: flex;
			gap: 8px;
			align-items: center;
			margin-left: auto;
		}

		#control-fullscreen {
			margin-left: 0;
		}

		#cc-toggle {
			width: 44px;
			height: 44px;
			border-radius: 12px;
			border: none;
			cursor: pointer;
			display: grid;
			place-items: center;
			background: transparent;
			color: #f8fafc;
			font-size: 0.85rem;
			font-weight: 700;
			line-height: 1;
			transition: transform 120ms ease, box-shadow 120ms ease, background 120ms ease;
			text-shadow: 0 2px 4px rgba(0, 0, 0, 0.8);
			letter-spacing: 0.5px;
            margin-right: -10px;
            margin-left: -20px;
		}

		#cc-toggle:hover {
			background: transparent;
			box-shadow: none;
		}

		#cc-toggle:active {
			transform: scale(0.97);
		}

		#cc-toggle.active {
			color: #38bdf8;
		}

		#speed-toggle {
			width: 44px;
			height: 44px;
			border-radius: 12px;
			border: none;
			cursor: pointer;
			display: grid;
			place-items: center;
			background: transparent;
			color: #f8fafc;
			font-size: 0.95rem;
			font-weight: 600;
			line-height: 1;
			transition: transform 120ms ease, box-shadow 120ms ease, background 120ms ease;
			text-shadow: 0 2px 4px rgba(0, 0, 0, 0.8);
            margin-left: -8px;
		}

		#speed-toggle:hover {
			background: transparent;
			box-shadow: none;
		}

		#speed-toggle:active {
			transform: scale(0.97);
		}

		.speed.open #speed-toggle {
			background: transparent;
			color: #f8fafc;
			box-shadow: none;
		}

		.speed-menu {
			position: absolute;
			bottom: 50px;
			right: 0;
			display: none;
			flex-direction: column;
			gap: 2px;
			padding: 4px 10px;
			border-radius: 12px;
			background: rgba(10, 15, 24, 0.92);
			box-shadow: 0 22px 44px rgba(0, 0, 0, 0.45);
			backdrop-filter: blur(12px);
			min-width: 100px;
			z-index: 5;
			max-height: calc(100vh - 200px);
			overflow-y: auto;
		}

		.speed-menu button {
			width: 100%;
			padding: 6px 10px;
			border-radius: 8px;
			border: none;
			background: transparent;
			color: rgba(226, 232, 240, 0.9);
			font-size: 0.9rem;
			text-align: left;
			cursor: pointer;
			transition: background 120ms ease, color 120ms ease;
		}

		.speed-menu button:hover,
		.speed-menu button:focus-visible {
			background: transparent;
			color: #e0f2fe;
		}

		.speed-menu button.active {
			background: transparent;
			color: #38bdf8;
		}

		.speed.open .speed-menu {
			display: flex;
		}

		.status {
			min-height: 1.5em;
			margin-top: 18px;
			color: rgba(148, 163, 184, 0.9);
			text-align: center;
		}

		@media (max-width: 680px) {
			body {
				padding: 24px clamp(14px, 6vw, 28px) 140px;
				align-items: center;
			}

			.player-shell {
				width: 100%;
				max-width: 640px;
				margin: 0 auto;
				--shell-pad-x: 0;
				--shell-pad-y: 0;
				padding: 0 !important;
				border-radius: 18px;
			}

			.transcript-container {
				max-width: 640px;
			}

			h1 {
				font-size: 1.28rem;
				margin-bottom: 16px;
			}

			video {
				border-radius: 14px;
				height: 42vh;
				width: 100%;
				object-fit: fill;
			}
			
			.video-background {
				border-radius: 14px;
				height: 42vh;
			}

			.playback-overlay .overlay-circle {
				width: 64px;
				height: 64px;
				box-shadow: 0 14px 30px rgba(15, 23, 42, 0.3);
			}

			.playback-overlay svg {
				width: 42px;
				height: 42px;
			}

			.controls {
				gap: 8px;
				padding: 12px 14px 4px 14px;
				border-bottom-left-radius: 14px;
				border-bottom-right-radius: 14px;
			}

			.controls button,
			#speed-toggle {
				width: 36px;
				height: 36px;
				border-radius: 9px;
			}

			.controls .progress {
				order: 1;
				flex-basis: 100%;
				margin-top: 0;
			}

			.controls .primary-controls {
				order: 2;
				width: auto;
				margin-right: 0;
			}

			.controls .secondary-controls {
				order: 3;
				margin-left: auto;
			}

			.timecode {
				display: flex;
				align-items: center;
				height: 36px;
				font-size: 0.84rem;
				color: #f8fafc;
				margin-top: 0;
                margin-left: -10px;
			}

			.speed-menu {
				bottom: 42px;
			}
		}

		@media (max-width: 430px) {
			body {
				padding: 20px 3px 120px;
			}

			.player-shell {
				width: 100%;
				max-width: 420px;
				margin: 0 auto;
				--shell-pad-x: 0;
				--shell-pad-y: 0;
				padding: 0 !important;
			}

			.transcript-container {
				max-width: 420px;
				border-radius: 12px;
			}

			.controls {
				padding: 10px 10px 14px;
				gap: 6px;
				border-bottom-left-radius: 12px;
				border-bottom-right-radius: 12px;
			}

			video {
				border-radius: 12px;
				height: 38vh;
				width: 100%;
				object-fit: fill;
			}
			
			.video-background {
				border-radius: 12px;
				height: 38vh;
			}

			.playback-overlay .overlay-circle {
				width: 56px;
				height: 56px;
				box-shadow: 0 12px 24px rgba(15, 23, 42, 0.28);
			}

			.playback-overlay svg {
				width: 36px;
				height: 36px;
			}
			
			.background-content {
				padding: 20px;
			}
			
			.background-level {
				font-size: 0.9rem;
				margin-bottom: 8px;
			}
			
			.background-unit {
				font-size: 1.3rem;
				margin-bottom: 6px;
			}
			
			.background-title {
				font-size: 1.8rem;
			}

			.timecode {
				display: flex;
				align-items: center;
				height: 32px;
				font-size: 0.8rem;
				color: #f8fafc;
				margin-top: 0;
			}

			.controls .progress input[type="range"]::-webkit-slider-thumb,
			.controls .progress input[type="range"]::-moz-range-thumb {
				width: 10px;
				height: 10px;
			}

			.speed-menu {
				bottom: 38px;
			}
		}

		a {
			color: #38bdf8;
		}

		.loading-overlay {
			position: absolute;
			top: 0;
			left: 0;
			width: 100%;
			height: 100%;
			display: none;
			align-items: center;
			justify-content: center;
			background: rgba(0, 0, 0, 0.5);
			backdrop-filter: blur(4px);
			z-index: 10;
			border-radius: 18px;
		}

		.loading-overlay.active {
			display: flex;
		}

		.spinner-container {
			display: flex;
			flex-direction: column;
			align-items: center;
			gap: 16px;
		}

		.spinner {
			width: 48px;
			height: 48px;
			border: 4px solid rgba(56, 189, 248, 0.2);
			border-top-color: #38bdf8;
			border-radius: 50%;
			animation: spin 0.8s linear infinite;
		}

		.loading-text {
			color: #f8fafc;
			font-size: 0.95rem;
			font-weight: 500;
			text-shadow: 0 2px 4px rgba(0, 0, 0, 0.8);
		}

		@keyframes spin {
			to { transform: rotate(360deg); }
		}

		@media (max-width: 680px) {
			.loading-overlay {
				border-radius: 14px;
			}

			.spinner {
				width: 40px;
				height: 40px;
				border-width: 3px;
			}

			.loading-text {
				font-size: 0.88rem;
			}
		}

		@media (max-width: 430px) {
			.loading-overlay {
				border-radius: 12px;
			}

			.spinner {
				width: 36px;
				height: 36px;
			}

			.loading-text {
				font-size: 0.84rem;
			}
		}

		.transcript-container {
			width: 100%;
			max-width: 960px;
			margin: 5px auto 0;
			background: rgba(10, 15, 24, 0.96);
			backdrop-filter: blur(12px);
			border-radius: 18px;
			padding: 0;
			max-height: 0;
			overflow: hidden;
			box-sizing: border-box;
			transition: max-height 0.3s ease, padding 0.3s ease;
			box-shadow: 0 12px 32px rgba(0, 0, 0, 0.38);
			position: relative;
		}

		.transcript-close {
			position: absolute;
			top: 14px;
			right: 14px;
			width: 32px;
			height: 32px;
			border: none;
			border-radius: 999px;
			background: rgba(148, 163, 184, 0.2);
			color: rgba(226, 232, 240, 0.85);
			font-size: 16px;
			font-weight: 600;
			cursor: pointer;
			display: grid;
			place-items: center;
			transition: background 160ms ease, color 160ms ease, transform 160ms ease;
			opacity: 0;
			pointer-events: none;
			visibility: hidden;
		}

		.transcript-close:hover,
		.transcript-close:focus-visible {
			background: rgba(56, 189, 248, 0.25);
			color: #e0f2fe;
			outline: none;
		}
	.transcript-container.visible .transcript-close {
		opacity: 1;
		pointer-events: auto;
		visibility: visible;
	}

		.transcript-close:active {
			transform: scale(0.94);
		}

		.transcript-container.visible {
			max-height: 280px;
			padding: 24px;
			display: flex;
			flex-direction: column;
			gap: 16px;
		}

		.transcript-title {
			font-size: 1.2rem;
			font-weight: 600;
			color: #38bdf8;
			margin: 0;
			text-align: center;
		}

		.transcript-content {
			color: #e2e8f0;
			line-height: 1.8;
			font-size: 0.95rem;
			flex: 1;
			min-height: 0;
			overflow-y: auto;
			padding-right: 8px;
			margin-right: -4px;
		}

		.transcript-content p {
			margin: 0 0 12px 0;
		}

		.transcript-content strong {
			color: #38bdf8;
			font-weight: 600;
		}

		.transcript-content::-webkit-scrollbar {
			width: 8px;
		}

		.transcript-content::-webkit-scrollbar-track {
			background: rgba(148, 163, 184, 0.1);
			border-radius: 999px;
			margin: 6px 0;
		}

		.transcript-content::-webkit-scrollbar-thumb {
			background: rgba(56, 189, 248, 0.7);
			border-radius: 999px;
			border: 2px solid transparent;
			background-clip: padding-box;
		}

		.transcript-content::-webkit-scrollbar-thumb:hover {
			background: rgba(37, 99, 235, 0.85);
			background-clip: padding-box;
		}

		@media (max-width: 680px) {
			.transcript-container.visible {
				max-height: 220px;
				padding: 20px;
				gap: 12px;
			}

			.transcript-close {
				top: 10px;
				right: 10px;
				width: 28px;
				height: 28px;
				font-size: 14px;
			}

			.transcript-title {
				font-size: 1.1rem;
			}

			.transcript-content {
				font-size: 0.9rem;
				padding-right: 6px;
				margin-right: -2px;
			}
		}

		@media (max-width: 430px) {
			.transcript-container {
				border-radius: 12px;
			}

			.transcript-container.visible {
				max-height: 200px;
				padding: 16px;
				gap: 10px;
			}

			.transcript-close {
				top: 8px;
				right: 8px;
				width: 26px;
				height: 26px;
				font-size: 13px;
			}

			.transcript-title {
				font-size: 1rem;
			}

			.transcript-content {
				font-size: 0.85rem;
				padding-right: 4px;
				margin-right: -1px;
			}
		}
	</style>
</head>
<body>
	<div class="player-shell">
		<h1 style="text-align: center;">Una fiesta</h1>
		<div class="loading-overlay" id="loading-overlay">
			<div class="spinner-container">
				<div class="spinner"></div>
				<div class="loading-text">Cargando video...</div>
			</div>
		</div>
		<div style="position: relative;">
			<div class="video-background visible" id="video-background">
				<div class="background-content">
					<div class="background-level">Español A1</div>
					<div class="background-unit">Unidad 1: Nosotros y nosotras</div>
					<div class="background-title">Una fiesta</div>
				</div>
			</div>
			<video id="player" src="https://ik.imagekit.io/b8cowcw9j/video1.mp4" preload="auto" playsinline tabindex="0">
				Tu navegador no puede reproducir este video.
			</video>
			<div class="playback-overlay" id="playback-overlay" data-state="pause" aria-hidden="true">
				<span class="overlay-circle">
					<svg data-icon="play" viewBox="0 0 32 32" aria-hidden="true">
						<path d="M12 8v16l12-8z"></path>
					</svg>
					<svg data-icon="pause" viewBox="0 0 32 32" aria-hidden="true">
						<path d="M11 9h4v14h-4zm6 0h4v14h-4z"></path>
					</svg>
				</span>
			</div>
		</div>
		<div class="controls">
			<div class="progress" style="flex: 1 0 100%; order: 0;">
				<input id="seek" type="range" min="0" value="0" step="0.05" aria-label="Barra de progreso">
			</div>
			<div class="primary-controls" style="display: flex; flex-direction: row; align-items: center; gap: 12px;">
			<button id="control-play" type="button" aria-label="Reproducir" data-state="play">
				<svg class="icon icon-play" viewBox="0 0 32 32" aria-hidden="true"><path d="M10 6.5v19l16-9.5z"></path></svg>
				<svg class="icon icon-pause" viewBox="0 0 32 32" aria-hidden="true"><path d="M11 7h4v18h-4zm6 0h4v18h-4z"></path></svg>
				<svg class="icon icon-replay" viewBox="0 0 32 32" aria-hidden="true">
					<path d="M16 6 L16 2.5 L10.5 7 L16 11.5 L16 8 C20.4 8 24 11.6 24 16 C24 20.4 20.4 24 16 24 C11.6 24 8 20.4 8 16 L5 16 C5 22 9.9 27 16 27 C22.1 27 27 22 27 16 C27 10 22.1 5 16 5 Z"></path>
				</svg>
			</button>
				<div class="volume" id="volume-control">
					<button id="control-volume" type="button" aria-label="Silenciar" data-state="high" aria-haspopup="true" aria-expanded="false">
						<svg class="icon icon-volume-high" viewBox="0 0 32 32" aria-hidden="true"><path d="M6 12h5l6-5v18l-6-5H6zm15.5-6.5v3.3c2.2 0.9 3.5 2.6 3.5 4.7s-1.3 3.8-3.5 4.7v3.3c4-1.2 6.5-4.1 6.5-7.9s-2.6-6.7-6.5-7.9z"></path></svg>
						<svg class="icon icon-volume-muted" viewBox="0 0 32 32" aria-hidden="true"><path d="M6 12h5l6-5v18l-6-5H6zm16.8 3.6 2.6-2.6 1.6 1.6-2.6 2.6 2.6 2.6-1.6 1.6-2.6-2.6-2.6 2.6-1.6-1.6 2.6-2.6-2.6-2.6 1.6-1.6z"></path></svg>
					</button>
					<div class="volume-slider" id="volume-popover" role="presentation" aria-hidden="true">
						<input id="volume" type="range" min="0" max="1" step="0.01" value="0.5" aria-label="Volumen" orient="vertical">
					</div>
				</div>
				<div class="timecode" id="time">
					<span>00:00 / 00:00</span>
					<button id="forward-10" type="button" aria-label="Retrasar 10 segundos" class="skip-button">
						<svg class="icon" viewBox="0 0 32 32" aria-hidden="true">
							<path d="M16 8c-4.4 0-8 3.6-8 8s3.6 8 8 8 8-3.6 8-8h-2c0 3.3-2.7 6-6 6s-6-2.7-6-6 2.7-6 6-6v3l4-4-4-4v3z"></path>
							<text x="16" y="18" text-anchor="middle" font-size="7" font-weight="bold" fill="currentColor">10</text>
						</svg>
					</button>
					<button id="rewind-10" type="button" aria-label="Adelantar 10 segundos" class="skip-button1">
						<svg class="icon1" viewBox="0 0 32 32" aria-hidden="true">
							<path d="M16 8c4.4 0 8 3.6 8 8s-3.6 8-8 8-8-3.6-8-8h2c0 3.3 2.7 6 6 6s6-2.7 6-6-2.7-6-6-6v3l-4-4 4-4v3z"></path>
							<text x="16" y="18" text-anchor="middle" font-size="7" font-weight="bold" fill="currentColor">10</text>
						</svg>
					</button>
				</div>
		</div>
		<div class="secondary-controls">
			<button id="cc-toggle" type="button" aria-label="Subtítulos" title="Subtítulos">CC</button>
			<div class="speed" id="speed-control">
				<button id="speed-toggle" type="button" aria-haspopup="true" aria-expanded="false" aria-label="Cambiar velocidad">1x</button>
				<div id="speed-menu" class="speed-menu" role="menu" aria-label="Seleccionar velocidad">
					<button type="button" role="menuitemradio" data-rate="0.5">0,5×</button>
					<button type="button" role="menuitemradio" data-rate="0.75">0,75×</button>
					<button type="button" role="menuitemradio" data-rate="1" aria-checked="true">Normal</button>
					<button type="button" role="menuitemradio" data-rate="1.25">1,25×</button>
					<button type="button" role="menuitemradio" data-rate="1.5">1,5×</button>
					<button type="button" role="menuitemradio" data-rate="2">2×</button>
				</div>
			</div>
			<button id="control-fullscreen" type="button" aria-label="Pantalla completa" data-state="enter">
				<svg class="icon icon-enter" viewBox="0 0 32 32" aria-hidden="true"><path d="M6 6h8v2H8v6H6zm12 0h8v8h-2V8h-6zm6 12h2v8h-8v-2h6zm-14 6h6v2H6v-8h2z"></path></svg>
				<svg class="icon icon-exit" viewBox="0 0 32 32" aria-hidden="true">
					<g fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round">
						<path d="M16 13h-6.5V5.5"></path>
						<path d="M16 13h6.5V5.5"></path>
						<path d="M16 19h-6.5v7.5"></path>
						<path d="M16 19h6.5v7.5"></path>
					</g>
				</svg>
			</button>
		</div>
        </div>
	</div>
	<div class="transcript-container" id="transcript">
		<button type="button" class="transcript-close" id="transcript-close" aria-label="Cerrar transcripción">X</button>
		<div class="transcript-title">Transcripción del video</div>
		<div class="transcript-content">
			<p><strong>Melisa:</strong> Hola. ¿Qué tal?</p>
			<p><strong>Thom:</strong> Hola.</p>
			<p><strong>Melisa:</strong> Yo me llamo Melisa. ¿Y tú?</p>
			<p><strong>Thom:</strong> Thom.</p>
			<p><strong>Melisa:</strong> ¿Eres de Estados Unidos?</p>
			<p><strong>Thom:</strong> No, no… Soy inglés. Y tú eres… ¿venezolana?</p>
			<p><strong>Melisa:</strong> Sí, de Caracas.</p>
			<p><strong>Thom:</strong> ¿Y en qué trabajas?</p>
			<p><strong>Melisa:</strong> Soy periodista. Trabajo en una agencia de noticias.</p>
			<p><strong>Thom:</strong> ¡Ah! ¡Qué interesante!</p>
			<p><strong>Melisa:</strong> Salud.</p>
			<p><strong>Felipe:</strong> Hola.</p>
			<p><strong>Lucía:</strong> Hola. ¿Qué tal estás?</p>
			<p><strong>Felipe:</strong> Bien, bien… ¿Eres de aquí?</p>
			<p><strong>Lucía:</strong> Sí, de Madrid. ¿Y tú?</p>
			<p><strong>Felipe:</strong> Yo soy chileno.</p>
			<p><strong>Lucía:</strong> Ah, ¿estás aquí de vacaciones?</p>
			<p><strong>Felipe:</strong> No, trabajo aquí.</p>
			<p><strong>Lucía:</strong> ¿Y a qué te dedicas?</p>
			<p><strong>Felipe:</strong> Soy comercial. Disculpa, ¿cuál es tu nombre?</p>
			<p><strong>Lucía:</strong> Me llamo Lucía. ¿Tú cómo te llamas?</p>
			<p><strong>Felipe:</strong> Yo soy Felipe. Mucho gusto.</p>
			<p><strong>Lucía:</strong> Igualmente.</p>
			<p><strong>Lucía:</strong> Hola. Tú eres Thom, ¿verdad?</p>
			<p><strong>Thom:</strong> Sí, hola.</p>
			<p><strong>Lucía:</strong> Yo me llamo Lucía, encantada. Trabajo con Melisa.</p>
			<p><strong>Thom:</strong> Ah, ¿también eres periodista?</p>
			<p><strong>Lucía:</strong> Sí. Y tú, ¿en qué trabajas?</p>
			<p><strong>Thom:</strong> Soy estudiante de Medicina.</p>
			<p><strong>Lucía:</strong> ¡Ah! Un futuro médico.</p>
			<p><strong>Thom:</strong> Sí, sí.</p>
			<p><strong>Lucía:</strong> ¿Y de dónde eres?</p>
			<p><strong>Thom:</strong> Yo soy de Manchester, ¿y tú?</p>
			<p><strong>Lucía:</strong> De Madrid.</p>
			<p><strong>Thom:</strong> Ah, una ciudad muy bonita.</p>
		</div>
	</div>
	<p id="status" class="status" role="alert"></p>
	<script>
		const statusEl = document.getElementById("status");
		const player = document.getElementById("player");
		const loadingOverlay = document.getElementById("loading-overlay");
		const playBtn = document.getElementById("control-play");
		const seek = document.getElementById("seek");
		const timecode = document.getElementById("time");
		const timecodeText = timecode.querySelector("span");
		const volumeBtn = document.getElementById("control-volume");
		const volumeControl = document.getElementById("volume-control");
		const volumePopover = document.getElementById("volume-popover");
		const volumeSlider = document.getElementById("volume");
		const fullBtn = document.getElementById("control-fullscreen");
		const speedControl = document.getElementById("speed-control");
		const speedToggle = document.getElementById("speed-toggle");
		const speedMenu = document.getElementById("speed-menu");
		const speedOptions = [...speedMenu.querySelectorAll("button[data-rate]")];
		const ccToggle = document.getElementById("cc-toggle");
		const rewindBtn = document.getElementById("rewind-10");
		const forwardBtn = document.getElementById("forward-10");
		const transcript = document.getElementById("transcript");
		const transcriptClose = document.getElementById("transcript-close");
		const controlsContainer = document.querySelector(".controls");
		const playerShell = document.querySelector(".player-shell");
		const playbackOverlay = document.getElementById("playback-overlay");
		let volumeCycleStage = 0;
		let lastVolume = Number(volumeSlider.value) || 0.5;
		let volumeAutoHideTimeout;
		let playbackOverlayTimer;
		const HIDE_CONTROLS_DELAY = 3000;
		let controlsHideTimer;
		let controlsRevealedOnInteraction = false;
		let lastInteractionInput = "pointer";

		const rememberPointerInput = (event) => {
			lastInteractionInput = event.pointerType || (event.type.startsWith("touch") ? "touch" : "mouse");
		};

		document.addEventListener("pointerdown", rememberPointerInput, true);
		if (!window.PointerEvent) {
			document.addEventListener("mousedown", rememberPointerInput, true);
			document.addEventListener("touchstart", rememberPointerInput, true);
		}
		document.addEventListener("keydown", () => {
			lastInteractionInput = "keyboard";
		}, true);

		const formatTime = (seconds) => {
			if (!Number.isFinite(seconds)) {
				return "00:00";
			}
			const total = Math.max(seconds, 0);
			const h = Math.floor(total / 3600);
			const m = Math.floor((total % 3600) / 60);
			const s = Math.floor(total % 60);
			const base = `${m.toString().padStart(2, "0")}:${s.toString().padStart(2, "0")}`;
			return h > 0 ? `${h}:${base}` : base;
		};

		const updateSeekVisual = () => {
			if (!seek.max) {
				return;
			}
			const percent = (seek.value / seek.max) * 100;
			seek.style.setProperty("--seek-filled", `${percent}%`);
		};

		const updateVolumeVisual = () => {
			const percent = Number(volumeSlider.value) * 100;
			volumeSlider.style.setProperty("--volume-filled", `${percent}%`);
		};

		const openVolumeMenu = () => {
			volumeControl.classList.add("open");
			volumeBtn.setAttribute("aria-expanded", "true");
			volumePopover.setAttribute("aria-hidden", "false");
			scheduleVolumeAutoHide();
			bumpControls();
		};

		const closeVolumeMenu = (resetStage = false) => {
			clearTimeout(volumeAutoHideTimeout);
			volumeControl.classList.remove("open");
			volumeBtn.setAttribute("aria-expanded", "false");
			volumePopover.setAttribute("aria-hidden", "true");
			if (resetStage) {
				volumeCycleStage = 0;
			}
		};

		function scheduleVolumeAutoHide() {
			clearTimeout(volumeAutoHideTimeout);
			volumeAutoHideTimeout = window.setTimeout(() => {
				if (!volumeControl.classList.contains("open")) {
					return;
				}
				closeVolumeMenu(true);
			}, 3000);
		}

		function controlsAreHidden() {
			return !controlsContainer || controlsContainer.classList.contains("hidden");
		}

		function showControls() {
			if (!controlsContainer) {
				return;
			}
			controlsContainer.classList.remove("hidden");
		}

		function shouldDelayControlsHide() {
			if (volumeControl && volumeControl.classList.contains("open")) {
				return true;
			}
			if (speedControl && speedControl.classList.contains("open")) {
				return true;
			}
			if (controlsContainer && document.activeElement && controlsContainer.contains(document.activeElement)) {
				return lastInteractionInput === "keyboard";
			}
			return false;
		}

		function hideControls() {
			if (!controlsContainer) {
				return;
			}
			if (shouldDelayControlsHide()) {
				scheduleControlsAutoHide();
				return;
			}
			controlsContainer.classList.add("hidden");
			controlsRevealedOnInteraction = false;
		}

		function scheduleControlsAutoHide() {
			if (!controlsContainer) {
				return;
			}
			clearTimeout(controlsHideTimer);
			controlsHideTimer = window.setTimeout(() => {
				hideControls();
			}, HIDE_CONTROLS_DELAY);
		}

		function bumpControls() {
			if (!controlsContainer) {
				return;
			}
			showControls();
			scheduleControlsAutoHide();
		}

		const handleVolumePointer = (event) => {
			event.stopPropagation();
			scheduleVolumeAutoHide();
			bumpControls();
		};

		const flashPlaybackOverlay = (state) => {
			if (!playbackOverlay) {
				return;
			}
			const nextState = state === "pause" ? "pause" : "play";
			playbackOverlay.dataset.state = nextState;
			playbackOverlay.setAttribute("aria-hidden", "false");
			playbackOverlay.classList.remove("show");
			void playbackOverlay.offsetWidth;
			playbackOverlay.classList.add("show");
			clearTimeout(playbackOverlayTimer);
			playbackOverlayTimer = window.setTimeout(() => {
				playbackOverlay.classList.remove("show");
				playbackOverlay.setAttribute("aria-hidden", "true");
			}, 520);
		};

		const openTranscript = () => {
			if (!transcript) {
				return;
			}
			transcript.classList.add("visible");
			if (ccToggle) {
				ccToggle.classList.add("active");
			}
		};

		const closeTranscript = () => {
			if (!transcript) {
				return;
			}
			transcript.classList.remove("visible");
			if (ccToggle) {
				ccToggle.classList.remove("active");
			}
			if (transcriptClose) {
				transcriptClose.blur();
			}
		};

		const syncTime = () => {
			const duration = Number.isFinite(player.duration) ? player.duration : 0;
			timecodeText.textContent = `${formatTime(player.currentTime)} / ${formatTime(duration)}`;
			seek.value = player.currentTime;
			updateSeekVisual();
		};

	const togglePlay = () => {
		controlsRevealedOnInteraction = false;
		bumpControls();
		if (player.ended || playBtn.dataset.state === "replay") {
			player.currentTime = 0;
			player.play().catch(() => {});
		} else if (player.paused) {
			player.play().catch(() => {});
		} else {
			player.pause();
		}
	};		const updatePlayButton = () => {
			playBtn.dataset.state = player.paused ? "play" : "pause";
			playBtn.setAttribute("aria-label", player.paused ? "Reproducir" : "Pausar");
		};

		const updateVolumeButton = () => {
			const muted = player.muted || player.volume === 0;
			volumeBtn.dataset.state = muted ? "mute" : "high";
			volumeBtn.setAttribute("aria-label", muted ? "Activar sonido" : "Silenciar");
		};

		const toggleMute = () => {
			player.muted = !player.muted;
		};

		const getFullscreenTarget = () => playerShell || player.parentElement || player;

		const getActiveFullscreenElement = () => document.fullscreenElement
			|| document.webkitFullscreenElement
			|| document.mozFullScreenElement
			|| document.msFullscreenElement
			|| null;

		const isFullscreenActive = () => {
			const current = getActiveFullscreenElement();
			if (!current) {
				return false;
			}
			const target = getFullscreenTarget();
			return current === target;
		};

		const toggleFullscreen = () => {
			bumpControls();
			const target = getFullscreenTarget();
			if (!isFullscreenActive()) {
				if (target?.requestFullscreen) {
					target.requestFullscreen().catch(() => {});
					return;
				}
				if (target?.webkitRequestFullscreen) {
					target.webkitRequestFullscreen();
					return;
				}
				if (target?.mozRequestFullScreen) {
					target.mozRequestFullScreen();
					return;
				}
				if (target?.msRequestFullscreen) {
					target.msRequestFullscreen();
				}
			} else {
				if (document.exitFullscreen) {
					document.exitFullscreen().catch(() => {});
					return;
				}
				if (document.webkitExitFullscreen) {
					document.webkitExitFullscreen();
					return;
				}
				if (document.mozCancelFullScreen) {
					document.mozCancelFullScreen();
					return;
				}
				if (document.msExitFullscreen) {
					document.msExitFullscreen();
				}
			}
		};

		const updateFullscreenButton = () => {
			const active = isFullscreenActive();
			fullBtn.dataset.state = active ? "exit" : "enter";
			fullBtn.setAttribute("aria-label", active ? "Salir de pantalla completa" : "Pantalla completa");
		};

		const ORIENTATION_LOCK_QUERY = "(max-width: 1024px)";
		const orientationLockMediaQuery = typeof window.matchMedia === "function" ? window.matchMedia(ORIENTATION_LOCK_QUERY) : null;
		let orientationLockActive = false;

		const isHandheldViewport = () => Boolean(orientationLockMediaQuery?.matches);

		const isLikelyTouchDevice = () => {
			if (navigator.maxTouchPoints && navigator.maxTouchPoints > 0) {
				return true;
			}
			return "ontouchstart" in window;
		};

		const canLockOrientation = () => {
			const orientation = window.screen?.orientation;
			return Boolean(orientation && typeof orientation.lock === "function");
		};

		const requestLandscapeOrientation = async () => {
			if (!isHandheldViewport() || !isLikelyTouchDevice() || !canLockOrientation()) {
				orientationLockActive = false;
				return;
			}
			try {
				await window.screen.orientation.lock("landscape");
				orientationLockActive = true;
			} catch {
				orientationLockActive = false;
			}
		};

		const releaseOrientationLock = () => {
			if (!orientationLockActive) {
				return;
			}
			const orientation = window.screen?.orientation;
			if (!orientation || typeof orientation.unlock !== "function") {
				orientationLockActive = false;
				return;
			}
			try {
				orientation.unlock();
			} catch {
				// Ignore unlock errors on platforms that do not support it.
			}
			orientationLockActive = false;
		};

		const handleFullscreenChange = () => {
			const active = isFullscreenActive();
			updateFullscreenButton();
			if (active) {
				requestLandscapeOrientation();
			} else {
				releaseOrientationLock();
			}
		};

		const formatRate = (rate) => rate.toLocaleString("es-ES", { maximumFractionDigits: 2 });

		const closeSpeedMenu = () => {
			speedControl.classList.remove("open");
			speedToggle.setAttribute("aria-expanded", "false");
			speedMenu.setAttribute("aria-hidden", "true");
			bumpControls();
		};

		const openSpeedMenu = () => {
			speedControl.classList.add("open");
			speedToggle.setAttribute("aria-expanded", "true");
			speedMenu.setAttribute("aria-hidden", "false");
			bumpControls();
		};

		const toggleSpeedMenu = () => {
			if (speedControl.classList.contains("open")) {
				closeSpeedMenu();
			} else {
				openSpeedMenu();
				const active = speedOptions.find((btn) => btn.classList.contains("active"));
				active?.focus({ preventScroll: true });
			}
		};

		const updateSpeedVisuals = () => {
			const current = player.playbackRate;
			const label = current === 1 ? "1x" : `${formatRate(current)}x`;
			speedToggle.textContent = label;
			speedOptions.forEach((button) => {
				const rate = Number(button.dataset.rate);
				const active = Math.abs(rate - current) < 0.011;
				button.classList.toggle("active", active);
				button.setAttribute("aria-checked", active ? "true" : "false");
			});
		};

	playBtn.addEventListener("click", togglePlay);
	player.addEventListener("play", () => {
		updatePlayButton();
		flashPlaybackOverlay("play");
		bumpControls();
	});
	player.addEventListener("pause", () => {
		updatePlayButton();
		if (!player.ended) {
			flashPlaybackOverlay("pause");
		}
		bumpControls();
	});
	player.addEventListener("ended", () => {
		playBtn.dataset.state = "replay";
		playBtn.setAttribute("aria-label", "Reiniciar");
		flashPlaybackOverlay("play");
		bumpControls();
	});
	
	if (playerShell) {
		playerShell.addEventListener("click", (event) => {
			if (controlsContainer && controlsContainer.contains(event.target)) {
				bumpControls();
				return;
			}
			if (loadingOverlay && loadingOverlay.classList.contains("active") && loadingOverlay.contains(event.target)) {
				return;
			}
			if (controlsRevealedOnInteraction || controlsAreHidden()) {
				bumpControls();
				controlsRevealedOnInteraction = false;
				return;
			}
			togglePlay();
		});

		const handleSurfaceActivity = (event) => {
			if (controlsContainer && controlsContainer.contains(event.target)) {
				return;
			}
			if (event.type === "pointerdown" || event.type === "touchstart" || event.type === "mousedown") {
				controlsRevealedOnInteraction = controlsAreHidden();
			}
			bumpControls();
		};

		playerShell.addEventListener("pointermove", handleSurfaceActivity);
		playerShell.addEventListener("pointerdown", handleSurfaceActivity);
		playerShell.addEventListener("mousemove", handleSurfaceActivity);
		if (!window.PointerEvent) {
			playerShell.addEventListener("touchstart", (event) => {
				handleSurfaceActivity(event);
			}, { passive: true });
			playerShell.addEventListener("touchmove", (event) => {
				handleSurfaceActivity(event);
			}, { passive: true });
		}
	}

	if (controlsContainer) {
		const reinforceControlsVisible = () => bumpControls();
		controlsContainer.addEventListener("pointerenter", reinforceControlsVisible);
		controlsContainer.addEventListener("pointermove", reinforceControlsVisible);
		controlsContainer.addEventListener("pointerdown", reinforceControlsVisible);
		controlsContainer.addEventListener("pointerleave", () => {
			scheduleControlsAutoHide();
		});
		if (!window.PointerEvent) {
			controlsContainer.addEventListener("touchstart", reinforceControlsVisible, { passive: true });
			controlsContainer.addEventListener("touchmove", reinforceControlsVisible, { passive: true });
			controlsContainer.addEventListener("touchend", () => scheduleControlsAutoHide(), { passive: true });
			controlsContainer.addEventListener("touchcancel", () => scheduleControlsAutoHide(), { passive: true });
		}
		controlsContainer.addEventListener("focusin", () => {
			bumpControls();
		});
		controlsContainer.addEventListener("focusout", () => {
			window.requestAnimationFrame(() => {
				if (!controlsContainer.contains(document.activeElement)) {
					scheduleControlsAutoHide();
				}
			});
		});
	}

	if (transcriptClose) {
		transcriptClose.addEventListener("click", () => {
			closeTranscript();
			bumpControls();
		});
	}

	// Control de visibilidad del fondo informativo
	const videoBackground = document.getElementById("video-background");
	
	player.addEventListener("play", () => {
		if (videoBackground) {
			videoBackground.classList.remove("visible");
		}
	});
	
	player.addEventListener("ended", () => {
		if (videoBackground) {
			videoBackground.classList.add("visible");
		}
	});
	
	player.addEventListener("loadedmetadata", () => {
			const duration = Number.isFinite(player.duration) ? player.duration : 0;
			seek.max = duration;
			seek.disabled = duration === 0;
			syncTime();
			statusEl.textContent = "";
		});

		player.addEventListener("timeupdate", syncTime);

		seek.addEventListener("input", () => {
			const newTime = Number(seek.value);
			player.currentTime = newTime;
			const duration = Number.isFinite(player.duration) ? player.duration : 0;
			timecodeText.textContent = `${formatTime(newTime)} / ${formatTime(duration)}`;
			updateSeekVisual();
			bumpControls();
		});

		volumeSlider.addEventListener("input", () => {
			const level = Number(volumeSlider.value);
			player.volume = level;
			if (level > 0) {
				lastVolume = level;
				if (player.muted) {
					player.muted = false;
				}
			}
			updateVolumeVisual();
			scheduleVolumeAutoHide();
			bumpControls();
		});

		player.addEventListener("volumechange", () => {
			const current = player.muted ? 0 : player.volume;
			volumeSlider.value = current;
			if (!player.muted && current > 0) {
				lastVolume = current;
			}
			updateVolumeButton();
			updateVolumeVisual();
		});

		volumeBtn.addEventListener("click", (event) => {
			event.stopPropagation();
			bumpControls();
			const isMuted = player.muted || Number(volumeSlider.value) === 0;
			if (isMuted) {
				player.muted = false;
				const restored = lastVolume > 0 ? lastVolume : 0.5;
				player.volume = restored;
				openVolumeMenu();
				volumeSlider.focus({ preventScroll: true });
				volumeCycleStage = 1;
				return;
			}
			if (volumeCycleStage === 0) {
				openVolumeMenu();
				volumeSlider.focus({ preventScroll: true });
				volumeCycleStage = 1;
				return;
			}
			if (volumeCycleStage === 1) {
				closeVolumeMenu();
				volumeCycleStage = 2;
				return;
			}
			if (volumeCycleStage === 2) {
				lastVolume = Number(volumeSlider.value) || lastVolume || 0.5;
				player.muted = true;
				closeVolumeMenu(true);
				volumeCycleStage = 0;
				return;
			}
			// Fallback: reset and open
			volumeCycleStage = 0;
			openVolumeMenu();
		});

		volumePopover.addEventListener("click", handleVolumePointer);
		volumePopover.addEventListener("pointerdown", handleVolumePointer);
		volumePopover.addEventListener("pointermove", handleVolumePointer);
		volumeControl.addEventListener("pointerdown", handleVolumePointer);
		volumeControl.addEventListener("pointermove", handleVolumePointer);
		volumeSlider.addEventListener("focus", () => {
			openVolumeMenu();
			if (volumeCycleStage < 1) {
				volumeCycleStage = 1;
			}
		});
		volumeSlider.addEventListener("pointerdown", handleVolumePointer);
		volumeSlider.addEventListener("pointermove", handleVolumePointer);
		volumeSlider.addEventListener("mousedown", handleVolumePointer);
		volumeSlider.addEventListener("keydown", () => scheduleVolumeAutoHide());
		volumeSlider.addEventListener("touchstart", handleVolumePointer, { passive: true });
		volumeSlider.addEventListener("touchmove", handleVolumePointer, { passive: true });

		fullBtn.addEventListener("click", toggleFullscreen);
		document.addEventListener("fullscreenchange", handleFullscreenChange);
		document.addEventListener("fullscreenerror", releaseOrientationLock);
		document.addEventListener("webkitfullscreenchange", handleFullscreenChange);
		document.addEventListener("webkitfullscreenerror", releaseOrientationLock);
		document.addEventListener("mozfullscreenchange", handleFullscreenChange);
		document.addEventListener("mozfullscreenerror", releaseOrientationLock);
		document.addEventListener("MSFullscreenChange", handleFullscreenChange);
		document.addEventListener("MSFullscreenError", releaseOrientationLock);
		
		// Botón de subtítulos/transcripción
		ccToggle.addEventListener("click", () => {
			if (transcript && transcript.classList.contains("visible")) {
				closeTranscript();
			} else {
				openTranscript();
			}
			bumpControls();
		});
		
		// Botones de adelantar y retrasar
		rewindBtn.addEventListener("click", () => {
			player.currentTime = Math.max(0, player.currentTime - 10);
			bumpControls();
		});
		
		forwardBtn.addEventListener("click", () => {
			player.currentTime = Math.min(player.duration, player.currentTime + 10);
			bumpControls();
		});

		speedToggle.addEventListener("click", toggleSpeedMenu);

		speedOptions.forEach((button) => {
			button.addEventListener("click", () => {
				const rate = Number(button.dataset.rate);
				player.playbackRate = rate;
				updateSpeedVisuals();
				closeSpeedMenu();
				speedToggle.focus({ preventScroll: true });
			});
		});

		document.addEventListener("click", (event) => {
			if (!speedControl.contains(event.target)) {
				closeSpeedMenu();
			}
			if (!volumeControl.contains(event.target)) {
				closeVolumeMenu(true);
			}
		});

		document.addEventListener("keydown", (event) => {
			if (event.key !== "Escape") {
				return;
			}
			let handled = false;
			if (speedControl.classList.contains("open")) {
				closeSpeedMenu();
				speedToggle.focus({ preventScroll: true });
				handled = true;
			}
			if (volumeControl.classList.contains("open")) {
				closeVolumeMenu(true);
				volumeBtn.focus({ preventScroll: true });
				handled = true;
			}
			if (handled) {
				bumpControls();
				event.preventDefault();
			}
		});

		player.addEventListener("ratechange", updateSpeedVisuals);

		player.addEventListener("keydown", (event) => {
			if (event.code === "Space") {
				event.preventDefault();
				togglePlay();
			}
		});

		// Mostrar spinner cuando el video está esperando datos
		player.addEventListener("waiting", () => {
			loadingOverlay.classList.add("active");
		});

		// Ocultar spinner cuando el video puede reproducirse
		player.addEventListener("canplay", () => {
			loadingOverlay.classList.remove("active");
		});

		// Ocultar spinner cuando el video empieza a reproducirse
		player.addEventListener("playing", () => {
			loadingOverlay.classList.remove("active");
		});

		// Mostrar spinner durante la carga inicial
		player.addEventListener("loadstart", () => {
			loadingOverlay.classList.add("active");
		});

	player.addEventListener("error", () => {
		loadingOverlay.classList.remove("active");
		statusEl.textContent = "";
	});		player.volume = Number(volumeSlider.value);
		lastVolume = player.volume || lastVolume;
		updatePlayButton();
		updateVolumeButton();
		updateFullscreenButton();
		updateSeekVisual();
		updateVolumeVisual();
		player.playbackRate = 1;
		updateSpeedVisuals();
		closeSpeedMenu();
		closeVolumeMenu(true);
		bumpControls();
	</script>
</body>
</html>
